/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";var _e=Object.defineProperty;var st=Object.getOwnPropertyDescriptor;var nt=Object.getOwnPropertyNames;var lt=Object.prototype.hasOwnProperty;var dt=(l,e)=>{for(var t in e)_e(l,t,{get:e[t],enumerable:!0})},ct=(l,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of nt(e))!lt.call(l,r)&&r!==t&&_e(l,r,{get:()=>e[r],enumerable:!(i=st(e,r))||i.enumerable});return l};var ut=l=>ct(_e({},"__esModule",{value:!0}),l);var Tt={};dt(Tt,{default:()=>fe});module.exports=ut(Tt);var ot=require("obsidian");var De={vocabularyBooks:[],showDefinitionOnHover:!0,enableAutoHighlight:!0,highlightStyle:"underline",enableMasteredFeature:!0,showMasteredInSidebar:!0,blurDefinitions:!1,ttsTemplate:"https://dict.youdao.com/dictvoice?audio={{word}}&type=2",aiDictionary:{apiUrl:"",apiKey:"",model:"",prompt:`Please provide a concise definition for the word "{{word}}" based on this context:

Sentence: {{sentence}}

Format:
1) Part of speech
2) English definition
3) Chinese translation
4) Example sentence (use the original sentence if appropriate)`},autoLayoutEnabled:!0,cardWidth:260,cardHeight:120,highlightMode:"all",highlightPaths:"",fileNodeParseMode:"filename-with-alias"};var R=class{constructor(){this.root=new Q}addWord(e,t){let i=this.root,r=e.toLowerCase();for(let o of r)i.children.has(o)||i.children.set(o,new Q),i=i.children.get(o);i.isEndOfWord=!0,i.payload=t,i.word=e}findAllMatches(e){let t=[],i=e.toLowerCase();for(let r=0;r<i.length;r++){let o=this.root,a=r;for(;a<i.length&&o.children.has(i[a]);)if(o=o.children.get(i[a]),a++,o.isEndOfWord){let s=r===0||!Pe(i[r-1]),n=a===i.length||!Pe(i[a]);s&&n&&t.push({word:o.word||i.substring(r,a),from:r,to:a,payload:o.payload})}}return t}clear(){this.root=new Q}},Q=class{constructor(){this.children=new Map,this.isEndOfWord=!1,this.payload=null,this.word=null}};function Pe(l){return/[a-z0-9\p{Script=Han}\p{Script=Hiragana}\p{Script=Katakana}\p{Script=Hangul}]/iu.test(l)}function F(l,e="var(--color-accent)"){return l?{1:"var(--color-red)",2:"var(--color-orange)",3:"var(--color-yellow)",4:"var(--color-green)",5:"var(--color-cyan)",6:"var(--color-purple)",red:"var(--color-red)",orange:"var(--color-orange)",yellow:"var(--color-yellow)",green:"var(--color-green)",cyan:"var(--color-cyan)",blue:"var(--color-blue)",purple:"var(--color-purple)",pink:"var(--color-pink)",gray:"var(--color-base-60)",grey:"var(--color-base-60)",white:"var(--color-base-00)",black:"var(--color-base-100)"}[l.toLowerCase()]||l:e}function He(l,e=.1){return l.startsWith("var(--color-")?`color-mix(in srgb, ${l} ${e*100}%, transparent)`:l.startsWith("#")||l.startsWith("rgb")||l.startsWith("hsl")?`color-mix(in srgb, ${l} ${e*100}%, transparent)`:l}var ve=null;function ht(l,e){if(!l||!e)return null;let t=encodeURIComponent(e.trim());return l.split("{{word}}").join(t)}async function le(l,e){let t=ht(l.settings.ttsTemplate,e);if(t)try{ve||(ve=new Audio);let i=ve;i.src=t,await i.play()}catch(i){console.warn("HiWords TTS play failed:",i)}}function Ie(l){let e=l.trim();return e.includes("...")?{isPattern:!0,parts:e.split("...").map(i=>i.trim()).filter(i=>i.length>0),original:e}:{isPattern:!1,parts:[e],original:e}}function gt(l){return l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function de(l,e,t=0){let i=[];if(e.length===0)return i;if(e.length===1){let s=new RegExp(`\\b${gt(e[0])}\\b`,"gi"),n;for(;(n=s.exec(l))!==null;)i.push({from:t+n.index,to:t+n.index+n[0].length,matchedText:n[0],segments:[{from:t+n.index,to:t+n.index+n[0].length}]});return i}let r=l.toLowerCase(),o=e.map(s=>s.toLowerCase()),a=0;for(;a<l.length;){let s=r.indexOf(o[0],a);if(s===-1)break;if(!Le(l,s,s+e[0].length)){a=s+1;continue}let n=[];n.push({from:t+s,to:t+s+e[0].length});let u=s+e[0].length,h=!0;for(let c=1;c<e.length;c++){let g=pt(l,u),m=l.substring(u,g).toLowerCase().indexOf(o[c]);if(m===-1){h=!1;break}let _=u+m;if(!Le(l,_,_+e[c].length)){h=!1;break}n.push({from:t+_,to:t+_+e[c].length}),u=_+e[c].length}if(h){let c=s,g=u;i.push({from:t+c,to:t+g,matchedText:l.substring(c,g),segments:n})}a=s+1}return i}function pt(l,e){let t=[".",",","!","?",";",":",`
`],i=l.length;for(let r of t){let o=l.indexOf(r,e);o!==-1&&o<i&&(i=o)}return i}function Le(l,e,t){let i=e>0?l[e-1]:" ",r=t<l.length?l[t]:" ",o=a=>/[a-z0-9\p{Script=Han}\p{Script=Hiragana}\p{Script=Katakana}\p{Script=Hangul}]/iu.test(a);return!o(i)&&!o(r)}function be(l,e){let t=e.highlightMode||"all";if(t==="all")return!0;let r=(e.highlightPaths||"").split(",").map(s=>s.trim()).filter(s=>s.length>0);if(r.length===0)return t==="exclude";let o=l.replace(/^\/+|\/+$/g,""),a=r.some(s=>{let n=s.replace(/^\/+|\/+$/g,"");return o===n||o.startsWith(n+"/")});return t==="exclude"?!a:t==="include"?a:!0}function ce(l){let e=l.getBoundingClientRect(),t=window.innerHeight||document.documentElement.clientHeight,i=window.innerWidth||document.documentElement.clientWidth;return e.bottom>0&&e.right>0&&e.top<t&&e.left<i}function we(l){return!l.closest('.workspace-leaf-content[data-type="hover-editor"]')&&!l.closest('.workspace-leaf-content[data-type="file-explorer"]')&&!l.closest('.workspace-leaf-content[data-type="outline"]')&&!l.closest('.workspace-leaf-content[data-type="backlink"]')&&!l.closest('.workspace-leaf-content[data-type="tag"]')&&!l.closest('.workspace-leaf-content[data-type="search"]')&&!l.closest(".hover-popover")&&!l.closest(".popover")&&!l.closest(".suggestion-container")&&!l.closest(".modal")&&!l.closest(".workspace-split.mod-right-split")&&!l.closest(".workspace-split.mod-left-split")}function Ne(l){l.querySelectorAll(".hi-words-highlight").forEach(t=>{var r;let i=document.createTextNode(t.textContent||"");(r=t.parentNode)==null||r.replaceChild(i,t)}),l.normalize()}function q(l){let e=new R,t=l.getAllWordsForHighlight();for(let i of t){let r=l.getDefinition(i);r&&e.addWord(i,r)}return e}function Fe(l){let e=null,t=["pre","code","a","button","input","textarea","select",".math",".cm-inline-code",".internal-embed",".file-embed",".hi-words-tooltip"].join(","),i=(r,o)=>{let a=document.createTreeWalker(r,NodeFilter.SHOW_TEXT,{acceptNode:h=>{let c=h.parentElement,g=c!=null?c:null;return!g||g.closest(t)||g.closest(".hi-words-highlight")||!h.nodeValue||!h.nodeValue.trim()?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}}),s=l.settings.highlightStyle||"underline",n=[],u=a.nextNode();for(;u;)n.push(u),u=a.nextNode();for(let h of n){let c=h.nodeValue||"";if(!c)continue;let g=o.findAllMatches(c);if(!g||g.length===0)continue;g.sort((b,E)=>b.from-E.from||E.to-E.from-(b.to-b.from));let p=[],f=0;for(let b of g)b.from>=f&&(p.push(b),f=b.to);if(p.length===0)continue;let m=document.createDocumentFragment(),_=0;for(let b of p){b.from>_&&m.appendChild(document.createTextNode(c.slice(_,b.from)));let E=b.payload,L=F(E==null?void 0:E.color,"var(--color-base-60)"),T=document.createElement("span");T.className="hi-words-highlight",T.setAttribute("data-word",b.word),E!=null&&E.definition&&T.setAttribute("data-definition",E.definition),L&&T.setAttribute("data-color",L),T.setAttribute("data-style",s),L&&T.setAttribute("style",`--word-highlight-color: ${L}`),T.textContent=c.slice(b.from,b.to),m.appendChild(T),_=b.to}_<c.length&&m.appendChild(document.createTextNode(c.slice(_))),h.parentNode&&h.parentNode.replaceChild(m,h)}};l.registerMarkdownPostProcessor((r,o)=>{try{if(!l.settings.enableAutoHighlight)return;let a=o==null?void 0:o.sourcePath;if(a&&!l.shouldHighlightFile(a)||!we(r))return;let s=q(l.vocabularyManager);e=i,i(r,s)}catch(a){console.error("\u9605\u8BFB\u6A21\u5F0F\u9AD8\u4EAE\u5904\u7406\u5931\u8D25:",a)}}),l._refreshReadingModeHighlighter=()=>{mt(l,e)}}function mt(l,e){if(!(!l.settings.enableAutoHighlight||!e))try{let t=q(l.vocabularyManager);document.querySelectorAll(".markdown-preview-view .markdown-preview-sizer").forEach(r=>{let o=r;we(o)&&ce(o)&&(Ne(o),e(o,t))})}catch(t){console.error("\u5237\u65B0\u9605\u8BFB\u6A21\u5F0F\u9AD8\u4EAE\u5931\u8D25:",t)}}function Ve(l){let e=new WeakSet,t=null,i=(n,u)=>{if(!e.has(n)){e.add(n);try{Be(n,u,l.settings.highlightStyle||"underline")}catch(h){console.error("PDF \u6587\u672C\u5C42\u9AD8\u4EAE\u5904\u7406\u5931\u8D25:",h)}}},r=()=>{t&&window.clearTimeout(t),t=window.setTimeout(()=>{if(!l.settings.enableAutoHighlight)return;let n=l.app.workspace.getActiveFile();if(n&&!l.shouldHighlightFile(n.path))return;let u=q(l.vocabularyManager);document.querySelectorAll(".textLayer").forEach(c=>{c.closest(".pdf-container, .mod-pdf")&&i(c,u)}),t=null},300)},o=()=>{let n=new MutationObserver(u=>{let h=!1;u.forEach(c=>{c.addedNodes.forEach(g=>{if(g.nodeType===Node.ELEMENT_NODE){let p=g;(p.classList.contains("textLayer")||p.querySelector(".textLayer"))&&(h=!0),p.classList.contains("page")&&p.closest(".pdf-container, .mod-pdf")&&(h=!0)}})}),h&&r()});return n.observe(document.body,{childList:!0,subtree:!0,attributes:!1,characterData:!1}),n};l.registerEvent(l.app.workspace.on("layout-change",()=>{setTimeout(()=>{r()},500)})),l.registerEvent(l.app.workspace.on("active-leaf-change",n=>{var u;((u=n==null?void 0:n.view)==null?void 0:u.getViewType())==="pdf"&&setTimeout(()=>{r()},1e3)})),l.registerEvent(l.app.workspace.on("file-open",n=>{(n==null?void 0:n.extension)==="pdf"&&setTimeout(()=>{r()},1500)}));let a=o();setTimeout(()=>{r()},1e3);let s=()=>{t&&window.clearTimeout(t),a.disconnect()};l._pdfHighlighterCleanup=s,l._refreshPDFHighlighter=()=>{_t(l,e)}}function ft(l){l.querySelectorAll('span[role="presentation"]').forEach(t=>{if(t.querySelectorAll(".hi-words-highlight").length===0)return;let r="";t.childNodes.forEach(o=>{(o.nodeType===Node.TEXT_NODE||o.nodeType===Node.ELEMENT_NODE)&&(r+=o.textContent)}),t.innerHTML="",t.textContent=r})}function Be(l,e,t){l.querySelectorAll('span[role="presentation"]').forEach(r=>{if(r.closest(".hi-words-highlight")||r.closest(".hi-words-tooltip"))return;let o=r.textContent||"";if(!o.trim())return;let a=e.findAllMatches(o);if(!a||a.length===0)return;a.sort((c,g)=>c.from-g.from||g.to-g.from-(c.to-c.from));let s=[],n=0;for(let c of a)c.from>=n&&(s.push(c),n=c.to);if(s.length===0)return;let u=document.createDocumentFragment(),h=0;for(let c of s){c.from>h&&u.appendChild(document.createTextNode(o.slice(h,c.from)));let g=c.payload,p=F(g==null?void 0:g.color,"var(--color-base-60)"),f=document.createElement("span");f.className="hi-words-highlight hi-words-pdf-highlight",f.setAttribute("data-word",c.word),g!=null&&g.definition&&f.setAttribute("data-definition",g.definition),p&&f.setAttribute("data-color",p),f.setAttribute("data-style",t),p&&f.setAttribute("style",`--word-highlight-color: ${p}`),f.textContent=o.slice(c.from,c.to),u.appendChild(f),h=c.to}h<o.length&&u.appendChild(document.createTextNode(o.slice(h))),r.innerHTML="",r.appendChild(u)})}function _t(l,e){if(l.settings.enableAutoHighlight)try{let t=q(l.vocabularyManager);document.querySelectorAll(".textLayer").forEach(r=>{let o=r;o.closest(".pdf-container, .mod-pdf")&&ce(o)&&(e.delete(o),ft(o),Be(o,t,l.settings.highlightStyle||"underline"),e.add(o))})}catch(t){console.error("\u5237\u65B0 PDF \u9AD8\u4EAE\u5931\u8D25:",t)}}function Re(l){l._pdfHighlighterCleanup&&(l._pdfHighlighterCleanup(),delete l._pdfHighlighterCleanup)}var Ee=require("obsidian");var ee=require("obsidian");var ze=require("obsidian");var S=class{constructor(e,t){this.app=e,this.settings=t}updateSettings(e){this.settings=e}removeMarkdownFormatting(e){return e&&(e=e.replace(/\*\*(.*?)\*\*/g,"$1").replace(/__(.*?)__/g,"$1"),e=e.replace(/\*(.*?)\*/g,"$1").replace(/_(.*?)_/g,"$1"),e=e.replace(/`(.*?)`/g,"$1"),e=e.replace(/~~(.*?)~~/g,"$1"),e=e.replace(/==(.*?)==/g,"$1"),e=e.replace(/\[(.*?)\]\(.*?\)/g,"$1"),e.trim())}removeFrontmatter(e){if(!e)return e;if(e.charCodeAt(0)===65279&&(e=e.slice(1)),e.startsWith("---")){let t=e.indexOf(`
---`);if(t!==-1)return e.slice(t+4).replace(/^\r?\n/,"")}return e}async parseCanvasFile(e){var t,i;try{let r=await this.app.vault.cachedRead(e),o=JSON.parse(r),a=(i=(t=this.settings)==null?void 0:t.masteredDetection)!=null?i:"group",s=a==="group"?o.nodes.find(u=>u.type==="group"&&(u.label==="Mastered"||u.label==="\u5DF2\u638C\u63E1")):void 0,n=[];for(let u of o.nodes)if(u.type==="text"&&u.text){let h=this.parseTextNode(u,e.path);h&&(a==="group"?s&&this.isNodeInGroup(u,s)&&(h.mastered=!0):a==="color"&&u.color==="4"&&(h.mastered=!0),n.push(h))}else if(u.type==="file"&&u.file){let h=await this.parseFileNode(u,e.path);h&&(a==="group"?s&&this.isNodeInGroup(u,s)&&(h.mastered=!0):a==="color"&&u.color==="4"&&(h.mastered=!0),n.push(h))}return n}catch(r){return console.error(`Failed to parse canvas file ${e.path}:`,r),[]}}parseFromText(e,t,i){if(!e)return null;e=this.removeFrontmatter(e).trim();let r="",o=[],a="";try{let s=e.split(`
`);if(s.length===0||(r=s[0].replace(/^#+\s*/,"").trim(),r=this.removeMarkdownFormatting(r),!r))return null;if(s.length>1){let h=-1,c=-1;for(let g=1;g<s.length;g++){let p=s[g].trim();if(p.startsWith("*")&&p.endsWith("*")&&p.length>2){let m=p.slice(1,-1).split(",").map(_=>_.trim()).filter(_=>_);o.push(...m),h=g}else if(p!==""){c=g;break}}if(c>0&&c<s.length){for(;c<s.length&&s[c].trim()==="";)c++;c<s.length&&(a=s.slice(c).join(`
`).trim())}else h===-1&&(a=s.slice(1).join(`
`).trim())}if(!r)return null;let n=Ie(r);return{word:n.isPattern?n.original:r.toLowerCase(),aliases:o.length>0?o:void 0,definition:a,source:i,nodeId:t.id,color:t.color,isPattern:n.isPattern,patternParts:n.isPattern?n.parts:void 0}}catch(s){return console.error(`\u89E3\u6790\u8282\u70B9\u6587\u672C\u65F6\u51FA\u9519: ${s}`),null}}parseTextNode(e,t){return e.text?this.parseFromText(e.text,e,t):null}async parseFileNode(e,t){var i;try{let r=e.file;if(!r)return null;let o=this.app.vault.getAbstractFileByPath(r);if(!(o instanceof ze.TFile)||o.extension!=="md")return null;let a=((i=this.settings)==null?void 0:i.fileNodeParseMode)||"filename-with-alias",s=o.basename;if(a==="filename")return{word:s,aliases:[],definition:"",source:t,nodeId:e.id,color:e.color,mastered:!1};let n=await this.app.vault.cachedRead(o);if(a==="content")return this.parseFromText(n,e,t);if(a==="filename-with-alias"){let u=this.parseFromText(n,e,t);if(u&&u.word){let h=u.word,c=u.aliases||[],g=h!==s?[h,...c]:c;return{...u,word:s,aliases:g}}return{word:s,aliases:[],definition:"",source:t,nodeId:e.id,color:e.color,mastered:!1}}return null}catch(r){return console.error("\u89E3\u6790\u6587\u4EF6\u8282\u70B9\u5931\u8D25:",r),null}}static isCanvasFile(e){return e.extension==="canvas"}async validateCanvasFile(e){var t;try{let i=await this.app.vault.cachedRead(e),r=(t=i==null?void 0:i.trim())!=null?t:"";if(r==="")return!0;let o=JSON.parse(r),a=!("nodes"in o)||Array.isArray(o.nodes),s=!("edges"in o)||Array.isArray(o.edges);return a&&s}catch(i){return!0}}isNodeInGroup(e,t){let i=typeof e.x=="number"?e.x:0,r=typeof e.y=="number"?e.y:0,o=typeof e.width=="number"?e.width:200,a=typeof e.height=="number"?e.height:60,s=typeof t.x=="number"?t.x:0,n=typeof t.y=="number"?t.y:0,u=typeof t.width=="number"?t.width:300,h=typeof t.height=="number"?t.height:150,c=i,g=i+o,p=r,f=r+a,m=s,_=s+u,b=n,E=n+h;if(!(c>=m&&g<=_&&p>=b&&f<=E)){if(c<_&&g>m&&p<E&&f>b){let B=Math.max(c,m),G=Math.min(g,_),w=Math.max(p,b),M=Math.min(f,E),x=(G-B)*(M-w),A=o*a;return x>=A*.5}return!1}return!0}};var vt=50,bt=50,qe=260,Ue=120,Oe=20,Ge=3,ue=24,he=12,Z=2;function V(l,e,t){var s,n;if(!e.autoLayoutEnabled)return;let i=(s=e.cardWidth)!=null?s:qe,r=(n=e.cardHeight)!=null?n:Ue,o=l.nodes.find(u=>u.type==="group"&&u.label==="Mastered"),a=l.nodes.filter(u=>!(u.type==="group"||o&&t.isNodeInGroup(u,o)));if(a.length!==0)for(let u=0;u<a.length;u++){let h=a[u],c=u%Ge,g=Math.floor(u/Ge);h.x=vt+c*(i+Oe),h.y=bt+g*(r+Oe),h.width=i,h.height=r}}function ye(l,e,t,i){var h,c;let r=(h=t.cardWidth)!=null?h:qe,o=(c=t.cardHeight)!=null?c:Ue,a=l.nodes.filter(g=>g.type!=="group"&&i.isNodeInGroup(g,e));if(a.length===0)return;for(let g=0;g<a.length;g++){let p=a[g],f=g%Z,m=Math.floor(g/Z);p.x=e.x+ue+f*(r+he),p.y=e.y+ue+m*(o+he),p.width=r,p.height=o}let s=Math.ceil(a.length/Z),n=ue*2+Z*r+(Z-1)*he,u=ue*2+s*o+(s-1)*he;e.width=Math.max(e.width,n),e.height=Math.max(e.height,u)}var te=class{constructor(e,t){this.app=e,this.settings=t}updateSettings(e){this.settings=e}genHex16(){let e=new Uint8Array(8);return(window.crypto||window.msCrypto).getRandomValues(e),Array.from(e,t=>t.toString(16).padStart(2,"0")).join("")}async addWordToCanvas(e,t,i,r,o){try{let a=this.app.vault.getAbstractFileByPath(e);if(!a||!(a instanceof ee.TFile)||!S.isCanvasFile(a))return console.error(`\u65E0\u6548\u7684 Canvas \u6587\u4EF6: ${e}`),null;o&&(o=o.filter(u=>u&&u.trim().length>0),o.length===0&&(o=void 0));let s=new S(this.app,this.settings),n="";return await this.app.vault.process(a,u=>{var x,A;let h=JSON.parse(u||'{"nodes":[],"edges":[]}');Array.isArray(h.nodes)||(h.nodes=[]);let c=this.genHex16();n=c;let g=(x=this.settings.cardWidth)!=null?x:260,p=(A=this.settings.cardHeight)!=null?A:120,f=20,m=24,_=(y,C)=>typeof y=="number"?y:C,b=y=>({x:_(y.x,0),y:_(y.y,0),w:_(y.width,200),h:_(y.height,60)}),E=(y,C,N,W)=>y<N+W&&y+C>N,L=h.nodes.find(y=>y.type==="group"&&y.label&&(y.label==="Mastered"||y.label==="\u5DF2\u638C\u63E1")),T=L?b(L):void 0,B=0,G=0;if(h.nodes.length>0){let y;for(let C=h.nodes.length-1;C>=0;C--){let N=h.nodes[C];if(N.type!=="group"){if(T){let W=b(N),Y=E(W.x,W.w,T.x,T.w),at=E(W.y,W.h,T.y,T.h);if(Y&&at)continue}y=N;break}}if(y){let C=b(y);B=C.x,G=C.y+C.h+f}}T&&E(B,g,T.x,T.w)&&(B=T.x+T.w+m);let w=t;o&&o.length>0&&(w=`${t}
*${o.join(", ")}*`),i&&(w=`${w}

${i}`);let M={id:c,type:"text",x:B,y:G,width:g,height:p,text:w,color:r!==void 0?r.toString():void 0};return h.nodes.push(M),V(h,this.settings,s),JSON.stringify(h)}),n}catch(a){return console.error(`\u6DFB\u52A0\u8BCD\u6C47\u5230 Canvas \u5931\u8D25: ${a}`),null}}async updateWordInCanvas(e,t,i,r,o,a){try{let s=this.app.vault.getAbstractFileByPath(e);if(!s||!(s instanceof ee.TFile)||!S.isCanvasFile(s))return console.error(`\u65E0\u6548\u7684 Canvas \u6587\u4EF6: ${e}`),!1;a&&(a=a.filter(h=>h&&h.trim().length>0),a.length===0&&(a=void 0));let n=!1,u=new S(this.app);return await this.app.vault.process(s,h=>{let c=JSON.parse(h||'{"nodes":[],"edges":[]}');Array.isArray(c.nodes)||(c.nodes=[]);let g=c.nodes.findIndex(f=>f.id===t);if(g===-1)return console.error(`\u672A\u627E\u5230\u8282\u70B9: ${t}`),JSON.stringify(c);let p=i;return a&&a.length>0&&(p=`${i}
*${a.join(", ")}*`),r&&(p=`${p}

${r}`),c.nodes[g].text=p,o!==void 0&&(c.nodes[g].color=o.toString()),V(c,this.settings,u),n=!0,JSON.stringify(c)}),n}catch(s){return console.error(`\u66F4\u65B0 Canvas \u4E2D\u7684\u8BCD\u6C47\u5931\u8D25: ${s}`),!1}}async deleteWordFromCanvas(e,t){try{let i=this.app.vault.getAbstractFileByPath(e);if(!i||!(i instanceof ee.TFile)||!S.isCanvasFile(i))return console.error(`\u65E0\u6548\u7684 Canvas \u6587\u4EF6: ${e}`),!1;let r=!1,o=new S(this.app);return await this.app.vault.process(i,a=>{let s=JSON.parse(a||'{"nodes":[],"edges":[]}');Array.isArray(s.nodes)||(s.nodes=[]);let n=s.nodes.findIndex(u=>u.id===t);return n===-1?(console.warn(`\u672A\u627E\u5230\u8981\u5220\u9664\u7684\u8282\u70B9: ${t}`),JSON.stringify(s)):(s.nodes.splice(n,1),V(s,this.settings,o),r=!0,JSON.stringify(s))}),r}catch(i){return console.error(`\u4ECE Canvas \u4E2D\u5220\u9664\u8BCD\u6C47\u5931\u8D25: ${i}`),!1}}async setNodeColor(e,t,i){try{let r=this.app.vault.getAbstractFileByPath(e);if(!r||!(r instanceof ee.TFile)||!S.isCanvasFile(r))return console.error(`\u65E0\u6548\u7684 Canvas \u6587\u4EF6: ${e}`),!1;let o=!1,a=new S(this.app,this.settings);return await this.app.vault.process(r,s=>{let n=JSON.parse(s||'{"nodes":[],"edges":[]}');Array.isArray(n.nodes)||(n.nodes=[]);let u=n.nodes.findIndex(h=>h.id===t);return u===-1?(console.error(`\u672A\u627E\u5230\u8282\u70B9: ${t}`),JSON.stringify(n)):(i!==void 0?n.nodes[u].color=i.toString():delete n.nodes[u].color,V(n,this.settings,a),o=!0,JSON.stringify(n))}),o}catch(r){return console.error(`\u8BBE\u7F6E\u8282\u70B9\u989C\u8272\u5931\u8D25: ${r}`),!1}}};var ke=require("obsidian");var ie=class{constructor(e,t){this.MASTERED_GROUP_LABEL="Mastered";this.MASTERED_GROUP_COLOR="4";this.app=e,this.canvasParser=new S(e),this.settings=t}updateSettings(e){this.settings=e}genHex16(){let e=new Uint8Array(8);return(window.crypto||window.msCrypto).getRandomValues(e),Array.from(e,t=>t.toString(16).padStart(2,"0")).join("")}async ensureMasteredGroup(e){try{let t=await this.loadCanvas(e);if(!t)return null;let i=t.nodes.find(r=>r.type==="group"&&r.label===this.MASTERED_GROUP_LABEL);if(!i){let r=this.genHex16();return await this.modifyCanvas(e,o=>{let a=this.createMasteredGroup(o);a.id=r,o.nodes.push(a)}),r}return i.id}catch(t){return null}}async moveToMasteredGroup(e,t){try{let i=await this.ensureMasteredGroup(e);return i?await this.modifyCanvas(e,r=>{let o=r.nodes.find(n=>n.id===t),a=r.nodes.find(n=>n.id===i);if(!(!o||!a||!this.moveNodeToGroupOptimizedSync(o,a,r)))try{this.settings&&(ye(r,a,this.settings,this.canvasParser),V(r,this.settings,this.canvasParser))}catch(n){}}):!1}catch(i){return!1}}async removeFromMasteredGroup(e,t){try{return await this.modifyCanvas(e,i=>{let r=i.nodes.find(a=>a.id===t);if(!(!r||!i.nodes.find(a=>a.type==="group"&&a.label===this.MASTERED_GROUP_LABEL))){this.moveNodeOutOfGroupSync(r,i);try{this.settings&&V(i,this.settings,this.canvasParser)}catch(a){}}})}catch(i){return!1}}async isNodeInMasteredGroup(e,t){try{let i=await this.loadCanvas(e);if(!i)return!1;let r=i.nodes.find(a=>a.id===t);if(!r)return!1;let o=i.nodes.find(a=>a.type==="group"&&a.label===this.MASTERED_GROUP_LABEL);return o?this.canvasParser.isNodeInGroup(r,o):!1}catch(i){return!1}}createMasteredGroup(e){let t=this.genHex16(),{x:i,y:r}=this.calculateMasteredGroupPosition(e);return{id:t,type:"group",x:i,y:r,width:400,height:200,color:this.MASTERED_GROUP_COLOR,label:this.MASTERED_GROUP_LABEL}}calculateMasteredGroupPosition(e){let t=e.nodes.filter(g=>g.type==="text"||g.type==="group");if(t.length===0)return{x:50,y:50};let i=Math.min(...t.map(g=>g.x)),r=Math.max(...t.map(g=>g.x+(g.width||200))),o=Math.min(...t.map(g=>g.y)),a=Math.max(...t.map(g=>g.y+(g.height||100))),s=800,n=600,u=50,h=r+u,c=o;return h+s>3e3&&(h=i,c=a+u),{x:h,y:c}}moveNodeToGroupOptimizedSync(e,t,i){try{return e.width=e.width||260,e.height=e.height||120,e.x=Math.max(t.x+24,t.x),e.y=Math.max(t.y+24,t.y),!0}catch(r){return!1}}moveNodeOutOfGroupSync(e,t){let i=t.nodes.find(c=>c.type==="group"&&c.label===this.MASTERED_GROUP_LABEL),r=t.nodes.filter(c=>c.type!=="text"||c.id===e.id?!1:i?!this.canvasParser.isNodeInGroup(c,i):!0),o=50,a=20,s=e.width||260,n=e.height||120;if(r.length===0){e.x=o,e.y=a;return}let u=Math.min(...r.map(c=>c.x),o),h=Math.max(...r.map(c=>c.y+(c.height||n)),0);if(e.x=u,e.y=h+a,i){let c=i.y+i.height;e.y<c+a&&(e.y=c+a)}}getGroupMembers(e,t,i){return t.nodes.filter(r=>r.id!==e.id&&r.id!==i&&r.type!=="group"&&this.canvasParser.isNodeInGroup(r,e))}async loadCanvas(e){try{let t=this.app.vault.getAbstractFileByPath(e);if(!(t instanceof ke.TFile))return null;let i=await this.app.vault.cachedRead(t);return JSON.parse(i)}catch(t){return null}}async modifyCanvas(e,t){try{let i=this.app.vault.getAbstractFileByPath(e);return i instanceof ke.TFile?(await this.app.vault.process(i,r=>{let o=JSON.parse(r);return t(o),JSON.stringify(o)}),!0):!1}catch(i){return!1}}};var re=class{constructor(e,t){this.definitions=new Map;this.wordDefinitionCache=new Map;this.allWordsCache=[];this.bookWordsCache=new Map;this.cacheValid=!1;this.memoryOnlyWords=new Map;this.pendingSyncWords=new Map;this.syncTimeouts=new Map;this.tempNodeIdCounter=0;this.app=e,this.canvasParser=new S(e,t),this.canvasEditor=new te(e,t),this.settings=t}async loadAllVocabularyBooks(){this.definitions.clear(),this.invalidateCache();let e=this.settings.vocabularyBooks.filter(t=>t.enabled).map(t=>this.loadVocabularyBook(t));await Promise.all(e),this.rebuildCache()}async loadVocabularyBook(e){let t=this.app.vault.getAbstractFileByPath(e.path);if(!t||!(t instanceof Ee.TFile)){console.warn(`Canvas file not found: ${e.path}`);return}if(!S.isCanvasFile(t)){console.warn(`File is not a canvas: ${e.path}`);return}try{let i=await this.canvasParser.parseCanvasFile(t);this.definitions.set(e.path,i),this.updateCacheForBook(e.path,i)}catch(i){console.error(`Failed to load vocabulary book ${e.name}:`,i),this.definitions.delete(e.path),this.updateCacheForBook(e.path,[])}}getDefinition(e,t=new Set){let i=e.toLowerCase().trim();if(t.has(i))return null;if(t.add(i),this.cacheValid&&this.wordDefinitionCache.has(i))return this.wordDefinitionCache.get(i)||null;if(!this.cacheValid&&(this.rebuildCache(),this.wordDefinitionCache.has(i)))return this.wordDefinitionCache.get(i)||null;for(let r of this.definitions.values()){let o=r.find(s=>s.word===i);if(o)return this.wordDefinitionCache.set(i,o),o;let a=r.find(s=>s.aliases&&s.aliases.includes(i));if(a)return this.wordDefinitionCache.set(i,a),a}return null}getAllWords(){return this.cacheValid?[...this.allWordsCache]:(this.rebuildCache(),[...this.allWordsCache])}getAllWordsForHighlight(){if(!this.settings.enableMasteredFeature)return this.getAllWords();if(this.cacheValid){let t=[];for(let i of this.allWordsCache){let r=this.wordDefinitionCache.get(i);r&&!r.mastered&&t.push(i)}return t}this.rebuildCache();let e=[];for(let t of this.allWordsCache){let i=this.wordDefinitionCache.get(t);i&&!i.mastered&&e.push(t)}return e}getWordsFromBook(e){if(this.cacheValid&&this.bookWordsCache.has(e))return[...this.bookWordsCache.get(e)];let t=this.definitions.get(e);if(!t)return[];let i=[];i.push(...t.map(o=>o.word)),t.forEach(o=>{o.aliases&&o.aliases.length>0&&i.push(...o.aliases)});let r=[...new Set(i)];return this.bookWordsCache.set(e,r),r}async reloadVocabularyBook(e){let t=this.settings.vocabularyBooks.find(i=>i.path===e);t&&t.enabled&&(await this.loadVocabularyBook(t),this.invalidateCache())}removeBookData(e){this.definitions.delete(e),this.invalidateCache()}updateSettings(e){let t=this.settings;this.settings=e,(t.masteredDetection!==e.masteredDetection||t.fileNodeParseMode!==e.fileNodeParseMode||this.hasVocabularyBooksChanged(t.vocabularyBooks,e.vocabularyBooks))&&this.invalidateCache(),this.canvasEditor.updateSettings(e),this.canvasParser.updateSettings(e)}hasVocabularyBooksChanged(e,t){if(e.length!==t.length)return!0;for(let i=0;i<e.length;i++){let r=e[i],o=t[i];if(r.path!==o.path||r.enabled!==o.enabled||r.name!==o.name)return!0}return!1}getSettings(){return this.settings}getStats(){let e=this.settings.vocabularyBooks.length,t=this.settings.vocabularyBooks.filter(r=>r.enabled).length,i=0;for(let r of this.definitions.values())i+=r.length;return{totalBooks:e,enabledBooks:t,totalWords:i}}hasWord(e){let t=e.toLowerCase().trim();return this.cacheValid?this.wordDefinitionCache.has(t):this.getDefinition(e)!==null}clear(){this.definitions.clear(),this.invalidateCache()}async addWordToCanvas(e,t,i,r,o){try{let a={word:t,definition:i,source:e,nodeId:this.generateTempNodeId(),color:r?this.getColorString(r):void 0,aliases:o==null?void 0:o.filter(s=>s&&s.trim().length>0)};return this.addWordToMemoryCache(e,a),this.rebuildCache(),this.scheduleCanvasSync(e,a),!0}catch(a){return console.error("Failed to add word to canvas:",a),!1}}async setNodeColor(e,t,i){try{if(!await this.canvasEditor.setNodeColor(e,t,i))return!1;let o=this.definitions.get(e);if(o){let a=o.findIndex(s=>s.nodeId===t);if(a>=0){let s=o[a];s.color=i!==void 0?this.getColorString(i):void 0,this.wordDefinitionCache.set(s.word,s),s.aliases&&s.aliases.forEach(n=>this.wordDefinitionCache.set(n,s)),this.cacheValid=!1}}return!0}catch(r){return console.error("\u8BBE\u7F6E\u8282\u70B9\u989C\u8272\u5931\u8D25:",r),!1}}invalidateCache(){this.cacheValid=!1,this.wordDefinitionCache.clear(),this.allWordsCache=[],this.bookWordsCache.clear()}rebuildCache(){this.wordDefinitionCache.clear(),this.allWordsCache=[],this.bookWordsCache.clear();let e=new Set;for(let[t,i]of this.definitions.entries()){let r=new Set;for(let o of i){let a=o.word.toLowerCase().trim();if(this.wordDefinitionCache.set(a,o),e.add(a),r.add(a),o.aliases&&o.aliases.length>0)for(let s of o.aliases){let n=s.toLowerCase().trim();this.wordDefinitionCache.set(n,o),e.add(n),r.add(n)}}this.bookWordsCache.set(t,[...r])}this.allWordsCache=[...e],this.cacheValid=!0}updateCacheForBook(e,t){if(!this.cacheValid){this.rebuildCache();return}let i=this.bookWordsCache.get(e)||[],r=new Set(i);i.forEach(s=>{this.wordDefinitionCache.delete(s)}),this.allWordsCache=this.allWordsCache.filter(s=>!r.has(s));let o=new Set,a=new Set(this.allWordsCache);for(let s of t){let n=s.word.toLowerCase().trim();if(this.wordDefinitionCache.set(n,s),a.add(n),o.add(n),s.aliases&&s.aliases.length>0)for(let u of s.aliases){let h=u.toLowerCase().trim();this.wordDefinitionCache.set(h,s),a.add(h),o.add(h)}}this.allWordsCache=[...a],this.bookWordsCache.set(e,[...o])}async updateWordInCanvas(e,t,i,r,o,a){try{if(await this.canvasEditor.updateWordInCanvas(e,t,i,r,o,a)){let n={word:i,definition:r,source:e,nodeId:t,color:o?this.getColorString(o):void 0,aliases:a==null?void 0:a.filter(u=>u&&u.trim().length>0)};return this.updateWordInMemoryCache(e,t,n),this.rebuildCache(),!0}return!1}catch(s){return console.error("Failed to update word in canvas:",s),!1}}generateTempNodeId(){return`temp_${Date.now()}_${++this.tempNodeIdCounter}`}getColorString(e){return e>=1&&e<=6?e.toString():void 0}addWordToMemoryCache(e,t){let i=this.definitions.get(e);i||(i=[],this.definitions.set(e,i));let r=i.findIndex(o=>o.word===t.word);r>=0?i[r]=t:i.push(t),this.wordDefinitionCache.set(t.word,t),t.aliases&&t.aliases.forEach(o=>{this.wordDefinitionCache.set(o,t)}),this.cacheValid=!1}updateWordInMemoryCache(e,t,i){let r=this.definitions.get(e);if(!r){console.warn(`\u672A\u627E\u5230\u4E66\u672C: ${e}`);return}let o=r.findIndex(a=>a.nodeId===t);if(o>=0){let a=r[o];this.wordDefinitionCache.delete(a.word),a.aliases&&a.aliases.forEach(s=>{this.wordDefinitionCache.delete(s)}),r[o]=i,this.wordDefinitionCache.set(i.word,i),i.aliases&&i.aliases.forEach(s=>{this.wordDefinitionCache.set(s,i)}),this.cacheValid=!1}else console.warn(`\u672A\u627E\u5230\u8282\u70B9ID: ${t}`)}scheduleCanvasSync(e,t){let i=this.syncTimeouts.get(e);i&&window.clearTimeout(i),this.pendingSyncWords.has(e)||this.pendingSyncWords.set(e,[]),this.pendingSyncWords.get(e).push(t);let r=window.setTimeout(()=>{this.syncPendingWords(e)},1e3);this.syncTimeouts.set(e,r)}async syncPendingWords(e){let t=this.pendingSyncWords.get(e);if(!(!t||t.length===0))try{for(let i of t){let r=await this.canvasEditor.addWordToCanvas(e,i.word,i.definition,i.color?this.getColorNumber(i.color):void 0,i.aliases);r&&(i.nodeId=r)}this.pendingSyncWords.delete(e),this.syncTimeouts.delete(e)}catch(i){console.error("Failed to sync words to canvas:",i)}}getColorNumber(e){let t=parseInt(e,10);return t>=1&&t<=6?t:0}async deleteWordFromCanvas(e,t){try{return await this.canvasEditor.deleteWordFromCanvas(e,t)?(this.deleteWordFromMemoryCache(e,t),this.rebuildCache(),!0):!1}catch(i){return console.error("Failed to delete word from canvas:",i),!1}}deleteWordFromMemoryCache(e,t){let i=this.definitions.get(e);if(!i){console.warn(`\u672A\u627E\u5230\u4E66\u672C: ${e}`);return}let r=i.findIndex(o=>o.nodeId===t);if(r>=0){let o=i[r];this.wordDefinitionCache.delete(o.word),o.aliases&&o.aliases.forEach(s=>{this.wordDefinitionCache.delete(s)}),i.splice(r,1);let a=this.memoryOnlyWords.get(e);if(a){let s=a.findIndex(n=>n.nodeId===t);s>=0&&(a.splice(s,1),a.length===0&&this.memoryOnlyWords.delete(e))}this.cacheValid=!1}else console.warn(`\u672A\u627E\u5230\u8282\u70B9ID: ${t}`)}destroy(){this.syncTimeouts.forEach(e=>window.clearTimeout(e)),this.syncTimeouts.clear(),this.definitions.clear(),this.wordDefinitionCache.clear(),this.allWordsCache=[],this.bookWordsCache.clear(),this.memoryOnlyWords.clear(),this.pendingSyncWords.clear()}async getWordDefinitionByNodeId(e,t){let i=this.definitions.get(e);return i&&i.find(o=>o.nodeId===t)||null}async updateWordDefinition(e,t,i){let r=this.definitions.get(e);if(!r)return!1;let o=r.findIndex(s=>s.nodeId===t);if(o===-1)return!1;let a=r[o];r[o]=i,this.wordDefinitionCache.delete(a.word),a.aliases&&a.aliases.forEach(s=>this.wordDefinitionCache.delete(s)),this.wordDefinitionCache.set(i.word,i),i.aliases&&i.aliases.forEach(s=>this.wordDefinitionCache.set(s,i)),this.cacheValid=!1;try{await this.saveWordDefinitionToCanvas(e,t,i)}catch(s){console.error("\u4FDD\u5B58\u5355\u8BCD\u5B9A\u4E49\u5230 Canvas \u5931\u8D25:",s)}return!0}async saveWordDefinitionToCanvas(e,t,i){let r=this.app.vault.getAbstractFileByPath(e);if(!(r instanceof Ee.TFile))throw new Error(`Canvas \u6587\u4EF6\u4E0D\u5B58\u5728: ${e}`);try{await this.app.vault.process(r,o=>{let a=JSON.parse(o),s=a.nodes.find(u=>u.id===i.nodeId);if(!s)throw new Error(`\u627E\u4E0D\u5230\u8282\u70B9 ID: ${i.nodeId}`);let n=i.word;return i.aliases&&i.aliases.length>0&&(n+=`
*${i.aliases.join(", ")}*`),i.definition&&(n+=`
`+i.definition),s.text=n,JSON.stringify(a)})}catch(o){throw console.error("\u4FDD\u5B58 Canvas \u6587\u4EF6\u5931\u8D25:",o),o}}async getAllWordDefinitions(){let e=[];for(let t of this.definitions.values())e.push(...t);for(let t of this.memoryOnlyWords.values())e.push(...t);return e}async getWordDefinitionsByBook(e){let t=this.definitions.get(e)||[],i=this.memoryOnlyWords.get(e)||[];return[...t,...i]}async getUnmasteredWords(){this.cacheValid||this.rebuildCache();let e=[];for(let t of this.allWordsCache){let i=this.wordDefinitionCache.get(t);i&&!i.mastered&&e.push(t)}return e}async getMasteredWords(){this.cacheValid||this.rebuildCache();let e=[];for(let t of this.allWordsCache){let i=this.wordDefinitionCache.get(t);i&&i.mastered&&e.push(t)}return e}isWordMastered(e){let t=this.wordDefinitionCache.get(e.toLowerCase());return(t==null?void 0:t.mastered)===!0}};var D=require("obsidian");var Qe=require("obsidian");var $e={plugin_name:"HiWords",settings:{vocabulary_books:"Word books",add_vocabulary_book:"Add word book",remove_vocabulary_book:"Remove",show_definition_on_hover:"Show definition on hover",show_definition_on_hover_desc:"Show word definition when hovering over highlighted words",enable_auto_highlight:"Enable auto highlight",enable_auto_highlight_desc:"Automatically highlight words from vocabulary books while reading",highlight_style:"Highlight style",highlight_style_desc:"Choose how words are highlighted in text",style_underline:"Underline",style_background:"Background",style_bold:"Bold",style_dotted:"Dotted underline",style_wavy:"Wavy underline",save_settings:"Save settings",no_vocabulary_books:"No vocabulary books yet. Please add a Canvas file as a vocabulary book.",path:"Path",reload_book:"Reload this word book",statistics:"Statistics",total_books:"Total word books: {0}",enabled_books:"Enabled word books: {0}",total_words:"Total words: {0}",enable_mastered_feature:"Enable mastered feature",enable_mastered_feature_desc:"Mark mastered words to stop highlighting them. Sidebar shows grouped words",mastered_detection:"Mastered detection mode",mastered_detection_desc:"Choose how to detect 'mastered': by group or by color (green = 4)",mode_group:"Group mode",mode_color:"Color mode (green = 4)",blur_definitions:"Blur content",blur_definitions_desc:"Blur content by default, reveal on hover. Great for learning\u2014recall before seeing the answer",tts_template:"TTS template",tts_template_desc:"Use {{word}} as placeholder, e.g. https://dict.youdao.com/dictvoice?audio={{word}}&type=2",ai_dictionary:"AI Assistant",ai_api_url:"API URL",ai_api_url_desc:"Full API endpoint (e.g., .../v1/chat/completions)",ai_api_key:"API Key",ai_api_key_desc:"Your AI API key",ai_model:"Model ID",ai_model_desc:"AI model identifier (e.g., gpt-4o-mini, deepseek-chat)",ai_prompt:"Custom Prompt",ai_prompt_desc:"Use {{word}} and {{sentence}} as placeholders. The AI will use this prompt to generate definitions",auto_layout:"Canvas auto layout",enable_auto_layout:"Enable auto layout",enable_auto_layout_desc:"Automatically normalize layout after add/update/delete and group changes",card_size:"Card size",card_size_desc:"Default card size (Width \xD7 Height, default: 260 \xD7 120)",grid_gaps:"Grid gaps",grid_gaps_desc:"Horizontal/vertical gaps for the left grid",left_padding:"Left padding & min X",left_padding_desc:"Left padding from Mastered group and minimum X for the left area",columns_auto:"Auto columns",columns_auto_desc:"Auto determine columns (bounded by max columns)",columns:"Fixed columns / Max columns",columns_desc:"Specify fixed columns and max columns (effective when auto columns off)",group_inner_layout:"Group inner layout",group_inner_layout_desc:"Inner padding, gaps and columns for nodes inside groups",highlight_scope:"Highlight scope",highlight_mode:"Highlight mode",highlight_mode_desc:"Choose the scope mode for word highlighting",mode_all:"All files",mode_exclude:"Exclude specified paths",mode_include:"Only specified paths",highlight_paths:"File paths",highlight_paths_desc:"Separate multiple paths with commas, supports folder paths (including subfolders)",highlight_paths_placeholder:"e.g.: Archive, Templates, Private/Diary",file_node_parse_mode:"File node parse mode",file_node_parse_mode_desc:"Choose how to parse file cards in Canvas",mode_filename:"Filename only",mode_content:"File content only",mode_filename_with_alias:"Filename as word, content as alias"},sidebar:{title:"HiWords",empty_state:"No words found. Add words to your vocabulary books to see them here.",source_prefix:"From: ",found:"Found",words:"words",no_definition:"No definition available.",vocabulary_book:"Words",mastered:"Mastered",no_learning_words:"No words to learn",no_mastered_words:"No mastered words"},commands:{refresh_vocabulary:"Refresh vocabulary",add_word:"HiWords: Add word",edit_word:"HiWords: Edit word",show_sidebar:"Show HiWords sidebar",add_selected_word:"Add word"},notices:{enter_word_first:"Please enter a word first",definition_fetched:"Definition fetched successfully",definition_fetch_failed:"Failed to fetch definition. Please check your network or try another word",vocabulary_refreshed:"Vocabulary books refreshed",word_added:"Word added to vocabulary book",word_exists:"Word already exists in vocabulary book",error_adding_word:"Error adding word to vocabulary book",select_book_required:"Please select a vocabulary book",adding_word:"Adding word to vocabulary book...",updating_word:"Updating word...",word_added_success:'Word "{0}" successfully added to vocabulary book',word_updated_success:'Word "{0}" successfully updated',add_word_failed:"Failed to add word, please check the vocabulary book file",update_word_failed:"Failed to update word, please check the vocabulary book file",error_processing_word:"Error processing word",no_canvas_files:"No Canvas files found",book_already_exists:"This vocabulary book already exists",invalid_canvas_file:"Invalid Canvas file",book_added:"Added vocabulary book: {0}",book_reloaded:"Reloaded vocabulary book: {0}",book_removed:"Removed vocabulary book: {0}",deleting_word:"Deleting word...",word_deleted:"Word deleted",delete_word_failed:"Failed to delete word, please check the vocabulary book file",error_deleting_word:"Error occurred while deleting word",mastered_feature_disabled:"Mastered feature is not enabled",update_word_status_failed:"Failed to update word status",move_to_mastered_group_failed:"Failed to move to mastered group",word_marked_as_mastered:'"{0}" marked as mastered',mark_mastered_failed:"Failed to mark as mastered, please try again",remove_from_mastered_group_failed:"Failed to remove from mastered group",word_unmarked_as_mastered:'"{0}" unmarked as mastered',no_text_selected:"Please select text to add as a word",word_required:"Please enter a word",unmark_mastered_failed:"Failed to unmark as mastered, please try again",batch_marked_success:"Successfully marked {0} words as mastered",book_path_updated:"Vocabulary book path updated: {0}"},modals:{auto_fill_definition:"AI Define",word_label:"Word",word_placeholder:"Enter word to add...",definition_label:"Definition",book_label:"Vocabulary book",select_book:"Select a vocabulary book",color_label:"Card color",color_gray:"Gray",color_red:"Red",color_orange:"Orange",color_yellow:"Yellow",color_green:"Green",color_blue:"Blue",color_purple:"Purple",aliases_label:"Aliases (optional, comma separated)",aliases_placeholder:"e.g.: doing, done, did",definition_placeholder:"Enter word definition...",add_button:"Add",save_button:"Save",cancel_button:"Cancel",select_canvas_file:"Select vocabulary book file",delete_confirmation:`Are you sure you want to delete the word "{0}"?
This action cannot be undone.`},actions:{expand:"Expand",collapse:"Collapse",mark_mastered:"Mark mastered",unmark_mastered:"Unmark mastered"},ai_errors:{word_empty:"Word cannot be empty",api_key_not_configured:"API Key is not configured. Please set it in the plugin settings",api_url_required:"API URL is required. Please set it in the plugin settings",model_required:"Model ID is required. Please set it in the plugin settings",prompt_required:"Custom prompt is required. Please set it in the plugin settings",invalid_api_url:"Invalid API URL format. Please check the URL in plugin settings",prompt_missing_word_placeholder:"Prompt must contain {{word}} placeholder",invalid_response:"API returned an invalid response format",api_key_invalid:"\u274C API Key is invalid or expired. Please check plugin settings",rate_limit:"\u23F1\uFE0F API rate limit exceeded. Please try again later",server_error:"\u{1F527} API service is temporarily unavailable. Please try again later",network_error:"\u{1F310} Network connection failed. Please check your network settings",request_failed:"AI dictionary request failed"}};var je={plugin_name:"HiWords",settings:{vocabulary_books:"\u5355\u8BCD\u672C",add_vocabulary_book:"\u6DFB\u52A0\u5355\u8BCD\u672C",remove_vocabulary_book:"\u79FB\u9664",show_definition_on_hover:"\u60AC\u505C\u663E\u793A\u91CA\u4E49",show_definition_on_hover_desc:"\u9F20\u6807\u60AC\u505C\u5728\u9AD8\u4EAE\u8BCD\u6C47\u4E0A\u65F6\u663E\u793A\u5B9A\u4E49",enable_auto_highlight:"\u542F\u7528\u81EA\u52A8\u9AD8\u4EAE",enable_auto_highlight_desc:"\u5728\u9605\u8BFB\u65F6\u81EA\u52A8\u9AD8\u4EAE\u751F\u8BCD\u672C\u4E2D\u7684\u8BCD\u6C47",highlight_style:"\u9AD8\u4EAE\u6837\u5F0F",highlight_style_desc:"\u9009\u62E9\u5355\u8BCD\u5728\u6587\u672C\u4E2D\u7684\u9AD8\u4EAE\u663E\u793A\u65B9\u5F0F",style_underline:"\u4E0B\u5212\u7EBF",style_background:"\u80CC\u666F\u9AD8\u4EAE",style_bold:"\u7C97\u4F53",style_dotted:"\u70B9\u72B6\u4E0B\u5212\u7EBF",style_wavy:"\u6CE2\u6D6A\u7EBF",save_settings:"\u4FDD\u5B58\u8BBE\u7F6E",no_vocabulary_books:"\u6682\u65E0\u5355\u8BCD\u672C\uFF0C\u8BF7\u6DFB\u52A0 Canvas \u6587\u4EF6\u4F5C\u4E3A\u5355\u8BCD\u672C",path:"\u8DEF\u5F84",reload_book:"\u91CD\u65B0\u89E3\u6790\u8BE5\u5355\u8BCD\u672C",statistics:"\u7EDF\u8BA1\u4FE1\u606F",total_books:"\u603B\u5355\u8BCD\u672C\u6570\u91CF: {0}",enabled_books:"\u5DF2\u542F\u7528\u5355\u8BCD\u672C: {0}",total_words:"\u603B\u8BCD\u6C47\u6570\u91CF: {0}",enable_mastered_feature:"\u542F\u7528\u5DF2\u638C\u63E1\u529F\u80FD",enable_mastered_feature_desc:"\u6807\u8BB0\u5DF2\u638C\u63E1\u5355\u8BCD\u4EE5\u505C\u6B62\u9AD8\u4EAE\u663E\u793A\u3002\u4FA7\u8FB9\u680F\u663E\u793A\u5206\u7EC4\u5355\u8BCD",mastered_detection:"\u5DF2\u638C\u63E1\u5224\u5B9A\u6A21\u5F0F",mastered_detection_desc:"\u9009\u62E9\u7528\u4E8E\u5224\u5B9A\u201C\u5DF2\u638C\u63E1\u201D\u7684\u65B9\u5F0F\uFF1A\u5206\u7EC4\u6216\u989C\u8272\uFF08\u7EFF\u8272=4\uFF09",mode_group:"\u5206\u7EC4\u6A21\u5F0F",mode_color:"\u989C\u8272\u6A21\u5F0F\uFF08\u7EFF\u8272=4\uFF09",blur_definitions:"\u6A21\u7CCA\u5185\u5BB9",blur_definitions_desc:"\u9ED8\u8BA4\u6A21\u7CCA\u663E\u793A\u5185\u5BB9\uFF0C\u9F20\u6807\u60AC\u505C\u65F6\u663E\u793A\u6E05\u6670\u5185\u5BB9\u3002\u9002\u5408\u5B66\u4E60\u65F6\u5148\u56DE\u5FC6\u518D\u67E5\u770B\u7B54\u6848",tts_template:"\u53D1\u97F3\u5730\u5740\u6A21\u677F",tts_template_desc:"\u4F7F\u7528 {{word}} \u4F5C\u4E3A\u5360\u4F4D\u7B26\uFF0C\u4F8B\u5982\uFF1Ahttps://dict.youdao.com/dictvoice?audio={{word}}&type=2",ai_dictionary:"AI \u52A9\u624B",ai_api_url:"API \u5730\u5740",ai_api_url_desc:"\u5B8C\u6574\u7684 API \u7AEF\u70B9\u5730\u5740\uFF08\u5982\uFF1A.../v1/chat/completions\uFF09",ai_api_key:"API Key",ai_api_key_desc:"\u4F60\u7684 AI API \u5BC6\u94A5",ai_model:"\u6A21\u578B ID",ai_model_desc:"AI \u6A21\u578B\u6807\u8BC6\u7B26 (\u4F8B\u5982: gpt-4o-mini, deepseek-chat)",ai_prompt:"\u81EA\u5B9A\u4E49\u63D0\u793A\u8BCD",ai_prompt_desc:"\u4F7F\u7528 {{word}} \u548C {{sentence}} \u4F5C\u4E3A\u5360\u4F4D\u7B26\u3002AI \u5C06\u4F7F\u7528\u6B64\u63D0\u793A\u8BCD\u751F\u6210\u91CA\u4E49",auto_layout:"\u767D\u677F\u81EA\u52A8\u5E03\u5C40",enable_auto_layout:"\u542F\u7528\u81EA\u52A8\u5E03\u5C40",enable_auto_layout_desc:"\u5728\u6DFB\u52A0/\u66F4\u65B0/\u5220\u9664\u8282\u70B9\u548C\u5206\u7EC4\u53D8\u66F4\u540E\u81EA\u52A8\u89C4\u8303\u5316\u5E03\u5C40",card_size:"\u5361\u7247\u5C3A\u5BF8",card_size_desc:"\u9ED8\u8BA4\u5361\u7247\u5C3A\u5BF8\uFF08\u5BBD \xD7 \u9AD8\uFF0C\u9ED8\u8BA4\uFF1A260 \xD7 120\uFF09",grid_gaps:"\u7F51\u683C\u95F4\u8DDD",grid_gaps_desc:"\u5DE6\u4FA7\u533A\u57DF\u7F51\u683C\u7684\u6C34\u5E73/\u5782\u76F4\u95F4\u8DDD",left_padding:"\u5DE6\u4FA7\u7559\u767D\u4E0E\u6700\u5C0FX",left_padding_desc:"Mastered \u5206\u7EC4\u5DE6\u4FA7\u7684\u7559\u767D\u4E0E\u5DE6\u4FA7\u533A\u57DF\u7684\u6700\u5C0F X \u4F4D\u7F6E",columns_auto:"\u81EA\u52A8\u5217\u6570",columns_auto_desc:"\u6839\u636E\u5185\u5BB9\u81EA\u9002\u5E94\u5217\u6570\uFF08\u53D7\u6700\u5927\u5217\u6570\u9650\u5236\uFF09",columns:"\u56FA\u5B9A\u5217\u6570/\u6700\u5927\u5217\u6570",columns_desc:"\u6307\u5B9A\u56FA\u5B9A\u5217\u6570\u4E0E\u6700\u5927\u5217\u6570\uFF08\u5F53\u5173\u95ED\u81EA\u52A8\u5217\u6570\u65F6\u751F\u6548\uFF09",group_inner_layout:"\u5206\u7EC4\u5185\u5E03\u5C40",group_inner_layout_desc:"\u5206\u7EC4\u5185\u90E8\u7684\u5185\u8FB9\u8DDD\u3001\u95F4\u8DDD\u4E0E\u5217\u6570\u8BBE\u7F6E",highlight_scope:"\u9AD8\u4EAE\u8303\u56F4",highlight_mode:"\u9AD8\u4EAE\u6A21\u5F0F",highlight_mode_desc:"\u9009\u62E9\u9AD8\u4EAE\u5355\u8BCD\u7684\u8303\u56F4\u6A21\u5F0F",mode_all:"\u5168\u90E8\u6587\u4EF6\u9AD8\u4EAE",mode_exclude:"\u6392\u9664\u6307\u5B9A\u8DEF\u5F84",mode_include:"\u4EC5\u6307\u5B9A\u8DEF\u5F84\u9AD8\u4EAE",highlight_paths:"\u6587\u4EF6\u8DEF\u5F84",highlight_paths_desc:"\u591A\u4E2A\u8DEF\u5F84\u7528\u9017\u53F7\u5206\u9694\uFF0C\u652F\u6301\u6587\u4EF6\u5939\u8DEF\u5F84\uFF08\u5305\u62EC\u5B50\u6587\u4EF6\u5939\uFF09",highlight_paths_placeholder:"\u4F8B\u5982\uFF1AArchive, Templates, Private/Diary",file_node_parse_mode:"\u6587\u4EF6\u8282\u70B9\u89E3\u6790\u6A21\u5F0F",file_node_parse_mode_desc:"\u9009\u62E9\u5982\u4F55\u89E3\u6790 Canvas \u4E2D\u7684\u6587\u4EF6\u5361\u7247",mode_filename:"\u4EC5\u6587\u4EF6\u540D",mode_content:"\u4EC5\u6587\u4EF6\u5185\u5BB9",mode_filename_with_alias:"\u6587\u4EF6\u540D\u4F5C\u4E3A\u4E3B\u8BCD\uFF0C\u5185\u5BB9\u4F5C\u4E3A\u522B\u540D"},sidebar:{title:"HiWords",empty_state:"\u672A\u627E\u5230\u5355\u8BCD\u3002\u6DFB\u52A0\u5355\u8BCD\u5230\u60A8\u7684\u751F\u8BCD\u672C\u4EE5\u5728\u6B64\u5904\u67E5\u770B\u3002",source_prefix:"\u6765\u81EA: ",found:"\u53D1\u73B0",words:"\u4E2A\u751F\u8BCD",no_definition:"\u6682\u65E0\u5B9A\u4E49",vocabulary_book:"\u8BCD\u6C47",mastered:"\u5DF2\u638C\u63E1",no_learning_words:"\u6CA1\u6709\u5F85\u5B66\u4E60\u7684\u5355\u8BCD",no_mastered_words:"\u6CA1\u6709\u5DF2\u638C\u63E1\u7684\u5355\u8BCD"},commands:{refresh_vocabulary:"\u5237\u65B0\u751F\u8BCD\u672C",add_word:"HiWords: \u6DFB\u52A0\u5355\u8BCD",edit_word:"HiWords: \u7F16\u8F91\u5355\u8BCD",show_sidebar:"\u663E\u793A HiWords \u4FA7\u8FB9\u680F",add_selected_word:"\u6DFB\u52A0\u5355\u8BCD"},notices:{enter_word_first:"\u8BF7\u5148\u8F93\u5165\u5355\u8BCD",definition_fetched:"\u91CA\u4E49\u83B7\u53D6\u6210\u529F",definition_fetch_failed:"\u83B7\u53D6\u91CA\u4E49\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u6216\u5C1D\u8BD5\u5176\u4ED6\u5355\u8BCD",vocabulary_refreshed:"\u751F\u8BCD\u672C\u5DF2\u5237\u65B0",word_added:"\u5355\u8BCD\u5DF2\u6DFB\u52A0\u5230\u751F\u8BCD\u672C",word_exists:"\u5355\u8BCD\u5DF2\u5B58\u5728\u4E8E\u751F\u8BCD\u672C\u4E2D",error_adding_word:"\u6DFB\u52A0\u5355\u8BCD\u5230\u751F\u8BCD\u672C\u65F6\u51FA\u9519",select_book_required:"\u8BF7\u9009\u62E9\u751F\u8BCD\u672C",adding_word:"\u6B63\u5728\u6DFB\u52A0\u8BCD\u6C47\u5230\u751F\u8BCD\u672C...",updating_word:"\u6B63\u5728\u66F4\u65B0\u8BCD\u6C47...",word_added_success:'\u8BCD\u6C47 "{0}" \u5DF2\u6210\u529F\u6DFB\u52A0\u5230\u751F\u8BCD\u672C',word_updated_success:'\u8BCD\u6C47 "{0}" \u5DF2\u6210\u529F\u66F4\u65B0',add_word_failed:"\u6DFB\u52A0\u8BCD\u6C47\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u751F\u8BCD\u672C\u6587\u4EF6",update_word_failed:"\u66F4\u65B0\u8BCD\u6C47\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u751F\u8BCD\u672C\u6587\u4EF6",error_processing_word:"\u5904\u7406\u8BCD\u6C47\u65F6\u51FA\u9519",no_canvas_files:"\u672A\u627E\u5230 Canvas \u6587\u4EF6",book_already_exists:"\u8BE5\u751F\u8BCD\u672C\u5DF2\u5B58\u5728",invalid_canvas_file:"\u65E0\u6548\u7684 Canvas \u6587\u4EF6",book_added:"\u5DF2\u6DFB\u52A0\u751F\u8BCD\u672C: {0}",book_reloaded:"\u5DF2\u91CD\u65B0\u52A0\u8F7D: {0}",book_removed:"\u5DF2\u5220\u9664\u751F\u8BCD\u672C: {0}",deleting_word:"\u6B63\u5728\u5220\u9664\u8BCD\u6C47...",word_deleted:"\u8BCD\u6C47\u5DF2\u5220\u9664",delete_word_failed:"\u5220\u9664\u8BCD\u6C47\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u751F\u8BCD\u672C\u6587\u4EF6",error_deleting_word:"\u5220\u9664\u8BCD\u6C47\u65F6\u53D1\u751F\u9519\u8BEF",mastered_feature_disabled:"\u5DF2\u638C\u63E1\u529F\u80FD\u672A\u542F\u7528",update_word_status_failed:"\u66F4\u65B0\u5355\u8BCD\u72B6\u6001\u5931\u8D25",move_to_mastered_group_failed:"\u79FB\u52A8\u5230\u5DF2\u638C\u63E1\u5206\u7EC4\u5931\u8D25",word_marked_as_mastered:'"{0}"\u5DF2\u6807\u8BB0\u4E3A\u5DF2\u638C\u63E1',mark_mastered_failed:"\u6807\u8BB0\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5",remove_from_mastered_group_failed:"\u4ECE\u5DF2\u638C\u63E1\u5206\u7EC4\u79FB\u9664\u5931\u8D25",word_unmarked_as_mastered:'"{0}"\u5DF2\u53D6\u6D88\u5DF2\u638C\u63E1\u6807\u8BB0',no_text_selected:"\u8BF7\u5148\u9009\u4E2D\u8981\u6DFB\u52A0\u7684\u5355\u8BCD",word_required:"\u8BF7\u8F93\u5165\u5355\u8BCD",unmark_mastered_failed:"\u53D6\u6D88\u6807\u8BB0\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5",batch_marked_success:"\u6210\u529F\u6807\u8BB0 {0} \u4E2A\u5355\u8BCD\u4E3A\u5DF2\u638C\u63E1",book_path_updated:"\u5355\u8BCD\u672C\u8DEF\u5F84\u5DF2\u66F4\u65B0: {0}"},modals:{auto_fill_definition:"AI \u91CA\u4E49",word_label:"\u5355\u8BCD",word_placeholder:"\u8F93\u5165\u8981\u6DFB\u52A0\u7684\u5355\u8BCD...",definition_label:"\u91CA\u4E49",book_label:"\u5355\u8BCD\u672C",select_book:"\u9009\u62E9\u5355\u8BCD\u672C",color_label:"\u5361\u7247\u989C\u8272",color_gray:"\u7070\u8272",color_red:"\u7EA2\u8272",color_orange:"\u6A59\u8272",color_yellow:"\u9EC4\u8272",color_green:"\u7EFF\u8272",color_blue:"\u84DD\u8272",color_purple:"\u7D2B\u8272",aliases_label:"\u522B\u540D\uFF08\u53EF\u9009\uFF0C\u7528\u9017\u53F7\u5206\u9694\uFF09",aliases_placeholder:"\u4F8B\u5982\uFF1Adoing, done, did",definition_placeholder:"\u8F93\u5165\u8BCD\u6C47\u91CA\u4E49...",add_button:"\u6DFB\u52A0",save_button:"\u4FDD\u5B58",cancel_button:"\u53D6\u6D88",select_canvas_file:"\u9009\u62E9 Canvas \u6587\u4EF6",delete_confirmation:`\u786E\u5B9A\u8981\u5220\u9664\u8BCD\u6C47 "{0}" \u5417\uFF1F
\u6B64\u64CD\u4F5C\u4E0D\u53EF\u64A4\u9500\u3002`},actions:{expand:"\u5C55\u5F00",collapse:"\u6536\u8D77",mark_mastered:"\u5DF2\u638C\u63E1",unmark_mastered:"\u5FD8\u8BB0\u4E86"},ai_errors:{word_empty:"\u5355\u8BCD\u4E0D\u80FD\u4E3A\u7A7A",api_key_not_configured:"API Key \u672A\u914D\u7F6E,\u8BF7\u5728\u63D2\u4EF6\u8BBE\u7F6E\u4E2D\u586B\u5199",api_url_required:"API \u5730\u5740\u4E0D\u80FD\u4E3A\u7A7A,\u8BF7\u5728\u63D2\u4EF6\u8BBE\u7F6E\u4E2D\u586B\u5199",model_required:"\u6A21\u578B ID \u4E0D\u80FD\u4E3A\u7A7A,\u8BF7\u5728\u63D2\u4EF6\u8BBE\u7F6E\u4E2D\u586B\u5199",prompt_required:"\u81EA\u5B9A\u4E49\u63D0\u793A\u8BCD\u4E0D\u80FD\u4E3A\u7A7A,\u8BF7\u5728\u63D2\u4EF6\u8BBE\u7F6E\u4E2D\u586B\u5199",invalid_api_url:"API \u5730\u5740\u683C\u5F0F\u65E0\u6548,\u8BF7\u68C0\u67E5\u63D2\u4EF6\u8BBE\u7F6E\u4E2D\u7684 URL",prompt_missing_word_placeholder:"\u63D0\u793A\u8BCD\u5FC5\u987B\u5305\u542B {{word}} \u5360\u4F4D\u7B26",invalid_response:"API \u8FD4\u56DE\u4E86\u65E0\u6548\u7684\u54CD\u5E94\u683C\u5F0F",api_key_invalid:"\u274C API Key \u65E0\u6548\u6216\u5DF2\u8FC7\u671F,\u8BF7\u68C0\u67E5\u63D2\u4EF6\u8BBE\u7F6E",rate_limit:"\u23F1\uFE0F API \u8BF7\u6C42\u9891\u7387\u8D85\u9650,\u8BF7\u7A0D\u540E\u518D\u8BD5",server_error:"\u{1F527} API \u670D\u52A1\u6682\u65F6\u4E0D\u53EF\u7528,\u8BF7\u7A0D\u540E\u518D\u8BD5",network_error:"\u{1F310} \u7F51\u7EDC\u8FDE\u63A5\u5931\u8D25,\u8BF7\u68C0\u67E5\u7F51\u7EDC\u8BBE\u7F6E",request_failed:"AI \u8BCD\u5178\u8BF7\u6C42\u5931\u8D25"}};var Ke={plugin_name:"HiWords",settings:{vocabulary_books:"Libros de palabras",add_vocabulary_book:"Agregar libro de palabras",remove_vocabulary_book:"Eliminar",show_definition_on_hover:"Mostrar definici\xF3n al pasar el cursor",show_definition_on_hover_desc:"Mostrar la definici\xF3n al pasar el cursor sobre palabras resaltadas",enable_auto_highlight:"Habilitar resaltado autom\xE1tico",enable_auto_highlight_desc:"Resaltar autom\xE1ticamente palabras de los libros mientras lees",highlight_style:"Estilo de resaltado",highlight_style_desc:"Elige c\xF3mo se resaltan las palabras en el texto",style_underline:"Subrayado",style_background:"Fondo",style_bold:"Negrita",style_dotted:"Subrayado punteado",style_wavy:"Subrayado ondulado",save_settings:"Guardar ajustes",no_vocabulary_books:"A\xFAn no hay libros. Agrega un archivo Canvas como libro de palabras.",path:"Ruta",reload_book:"Recargar este libro",statistics:"Estad\xEDsticas",total_books:"Libros totales: {0}",enabled_books:"Libros habilitados: {0}",total_words:"Palabras totales: {0}",enable_mastered_feature:"Habilitar funci\xF3n de dominadas",enable_mastered_feature_desc:"Marca palabras dominadas para dejar de resaltarlas. La barra lateral muestra grupos",blur_definitions:"Difuminar contenido",blur_definitions_desc:"Difuminar por defecto, mostrar al pasar el cursor. Ideal para recordar antes de ver la respuesta",tts_template:"Plantilla TTS",tts_template_desc:"Usar {{word}} como marcador de posici\xF3n, ej. https://dict.youdao.com/dictvoice?audio={{word}}&type=2",ai_dictionary:"Asistente AI",ai_api_url:"URL de API",ai_api_url_desc:"Punto final de API (detecta autom\xE1ticamente: OpenAI, Claude, Gemini)",ai_api_key:"Clave API",ai_api_key_desc:"Tu clave de API de AI",ai_model:"Modelo",ai_model_desc:"Nombre del modelo de AI (ej., gpt-4o-mini, deepseek-chat)",ai_prompt:"Prompt personalizado",ai_prompt_desc:"Usar {{word}} y {{sentence}} como marcadores de posici\xF3n. La AI usar\xE1 este prompt para generar definiciones",auto_layout:"Dise\xF1o autom\xE1tico del lienzo",enable_auto_layout:"Habilitar dise\xF1o autom\xE1tico",enable_auto_layout_desc:"Normalizar autom\xE1ticamente el dise\xF1o despu\xE9s de agregar/actualizar/eliminar y cambios de grupo",card_size:"Tama\xF1o de tarjeta",card_size_desc:"Tama\xF1o de tarjeta predeterminado (Ancho \xD7 Alto, predeterminado: 260 \xD7 120)",grid_gaps:"Espacios de la cuadr\xEDcula",grid_gaps_desc:"Espacios horizontal/vertical para la cuadr\xEDcula izquierda",left_padding:"Relleno izquierdo y X m\xEDnima",left_padding_desc:"Relleno izquierdo desde el grupo Mastered y X m\xEDnima para el \xE1rea izquierda",columns_auto:"Columnas autom\xE1ticas",columns_auto_desc:"Determinar columnas autom\xE1ticamente (limitado por columnas m\xE1ximas)",columns:"Columnas fijas / M\xE1ximo de columnas",columns_desc:"Especificar columnas fijas y m\xE1ximo de columnas (efectivo cuando auto est\xE1 desactivado)",group_inner_layout:"Dise\xF1o interno del grupo",group_inner_layout_desc:"Relleno interno, espacios y columnas para nodos dentro de grupos",highlight_scope:"\xC1mbito de resaltado",highlight_mode:"Modo de resaltado",highlight_mode_desc:"Elegir el modo de \xE1mbito para el resaltado de palabras",mode_all:"Todos los archivos",mode_exclude:"Excluir rutas especificadas",mode_include:"Solo rutas especificadas",highlight_paths:"Rutas de archivo",highlight_paths_desc:"Separar m\xFAltiples rutas con comas, admite rutas de carpetas (incluidas subcarpetas)",highlight_paths_placeholder:"ej.: Archive, Templates, Private/Diary",file_node_parse_mode:"Modo de an\xE1lisis de nodo de archivo",file_node_parse_mode_desc:"Elegir c\xF3mo analizar tarjetas de archivo en Canvas",mode_filename:"Solo nombre de archivo",mode_content:"Solo contenido de archivo",mode_filename_with_alias:"Nombre de archivo como palabra, contenido como alias"},sidebar:{title:"HiWords",empty_state:"No se encontraron palabras. Agrega palabras a tus libros para verlas aqu\xED.",source_prefix:"De: ",found:"Encontradas",words:"palabras",no_definition:"Sin definici\xF3n disponible.",vocabulary_book:"Palabras",mastered:"Dominadas",no_learning_words:"No hay palabras para aprender",no_mastered_words:"No hay palabras dominadas"},commands:{refresh_vocabulary:"Actualizar vocabulario",add_word:"HiWords: Agregar palabra",edit_word:"HiWords: Editar palabra",show_sidebar:"Mostrar barra lateral de HiWords",add_selected_word:"Agregar palabra"},notices:{vocabulary_refreshed:"Libros actualizados",word_added:"Palabra agregada al libro",word_exists:"La palabra ya existe en el libro",error_adding_word:"Error al agregar palabra al libro",select_book_required:"Selecciona un libro de palabras",adding_word:"Agregando palabra al libro...",updating_word:"Actualizando palabra...",word_added_success:'La palabra "{0}" se agreg\xF3 correctamente',word_updated_success:'La palabra "{0}" se actualiz\xF3 correctamente',add_word_failed:"No se pudo agregar la palabra, revisa el archivo del libro",update_word_failed:"No se pudo actualizar la palabra, revisa el archivo del libro",error_processing_word:"Error al procesar la palabra",no_canvas_files:"No se encontraron archivos Canvas",book_already_exists:"Este libro ya existe",invalid_canvas_file:"Archivo Canvas no v\xE1lido",book_added:"Libro agregado: {0}",book_reloaded:"Libro recargado: {0}",book_removed:"Libro eliminado: {0}",deleting_word:"Eliminando palabra...",word_deleted:"Palabra eliminada",delete_word_failed:"No se pudo eliminar la palabra, revisa el archivo del libro",error_deleting_word:"Ocurri\xF3 un error al eliminar la palabra",mastered_feature_disabled:"La funci\xF3n de dominadas no est\xE1 habilitada",update_word_status_failed:"No se pudo actualizar el estado de la palabra",move_to_mastered_group_failed:"No se pudo mover al grupo de dominadas",word_marked_as_mastered:'"{0}" marcada como dominada',mark_mastered_failed:"No se pudo marcar como dominada, int\xE9ntalo de nuevo",remove_from_mastered_group_failed:"No se pudo quitar del grupo de dominadas",word_unmarked_as_mastered:'"{0}" ya no est\xE1 marcada como dominada',no_text_selected:"Por favor, selecciona primero una palabra para agregar",word_required:"Por favor, ingresa una palabra",unmark_mastered_failed:"No se pudo desmarcar, int\xE9ntalo de nuevo",batch_marked_success:"Se marcaron correctamente {0} palabras como dominadas",book_path_updated:"Ruta del libro actualizada: {0}",new_notice:"Nuevo aviso"},modals:{auto_fill_definition:"Definir con AI",word_label:"Palabra",word_placeholder:"Ingresa la palabra a agregar...",definition_label:"Definici\xF3n",book_label:"Libro de palabras",select_book:"Selecciona un libro",color_label:"Color de tarjeta",color_gray:"Gris",color_red:"Rojo",color_orange:"Naranja",color_yellow:"Amarillo",color_green:"Verde",color_blue:"Azul",color_purple:"P\xFArpura",aliases_label:"Alias (opcional, separados por comas)",aliases_placeholder:"p. ej.: doing, done, did",definition_placeholder:"Introduce la definici\xF3n...",add_button:"Agregar",save_button:"Guardar",cancel_button:"Cancelar",select_canvas_file:"Seleccionar archivo del libro",delete_confirmation:`\xBFSeguro que deseas eliminar la palabra "{0}"?
Esta acci\xF3n no se puede deshacer.`},actions:{expand:"Expandir",collapse:"Contraer",mark_mastered:"Marcar como dominado",unmark_mastered:"Desmarcar dominado"},ai_errors:{word_empty:"La palabra no puede estar vac\xEDa",api_key_not_configured:"La clave API no est\xE1 configurada. Por favor, config\xFArela en los ajustes del plugin",invalid_response:"La API devolvi\xF3 un formato de respuesta no v\xE1lido",api_key_invalid:"\u274C La clave API no es v\xE1lida o ha caducado. Por favor, verifique la configuraci\xF3n del plugin",rate_limit:"\u23F1\uFE0F L\xEDmite de tasa de API excedido. Por favor, int\xE9ntelo de nuevo m\xE1s tarde",server_error:"\u{1F527} El servicio API no est\xE1 disponible temporalmente. Por favor, int\xE9ntelo de nuevo m\xE1s tarde",network_error:"\u{1F310} Fallo en la conexi\xF3n de red. Por favor, verifique su configuraci\xF3n de red",request_failed:"Solicitud al diccionario AI fall\xF3"}};var Xe={plugin_name:"HiWords",settings:{vocabulary_books:"Livres de mots",add_vocabulary_book:"Ajouter un livre",remove_vocabulary_book:"Supprimer",show_definition_on_hover:"Afficher la d\xE9finition au survol",show_definition_on_hover_desc:"Afficher la d\xE9finition en survolant les mots surlign\xE9s",enable_auto_highlight:"Activer le surlignage auto",enable_auto_highlight_desc:"Surligner automatiquement les mots des livres pendant la lecture",highlight_style:"Style de surlignage",highlight_style_desc:"Choisissez la fa\xE7on dont les mots sont surlign\xE9s",style_underline:"Soulign\xE9",style_background:"Fond",style_bold:"Gras",style_dotted:"Soulign\xE9 en pointill\xE9s",style_wavy:"Soulign\xE9 ondul\xE9",save_settings:"Enregistrer les r\xE9glages",no_vocabulary_books:"Aucun livre pour l'instant. Ajoutez un fichier Canvas comme livre de mots.",path:"Chemin",reload_book:"Recharger ce livre",statistics:"Statistiques",total_books:"Livres au total : {0}",enabled_books:"Livres activ\xE9s : {0}",total_words:"Mots au total : {0}",enable_mastered_feature:"Activer la fonction ma\xEEtris\xE9",enable_mastered_feature_desc:"Marquer les mots ma\xEEtris\xE9s pour arr\xEAter de les surligner. La barre lat\xE9rale affiche les groupes",blur_definitions:"Flouter le contenu",blur_definitions_desc:"Flouter par d\xE9faut, r\xE9v\xE9ler au survol. Id\xE9al pour m\xE9moriser avant de voir la r\xE9ponse",tts_template:"Mod\xE8le TTS",tts_template_desc:"Utiliser {{word}} comme espace r\xE9serv\xE9, ex. https://dict.youdao.com/dictvoice?audio={{word}}&type=2",ai_dictionary:"Assistant IA",ai_api_url:"URL de l'API",ai_api_url_desc:"Point de terminaison de l'API (d\xE9tecte automatiquement : OpenAI, Claude, Gemini)",ai_api_key:"Cl\xE9 API",ai_api_key_desc:"Votre cl\xE9 API IA",ai_model:"Mod\xE8le",ai_model_desc:"Nom du mod\xE8le IA (ex., gpt-4o-mini, deepseek-chat)",ai_prompt:"Prompt personnalis\xE9",ai_prompt_desc:"Utiliser {{word}} et {{sentence}} comme espaces r\xE9serv\xE9s. L'IA utilisera ce prompt pour g\xE9n\xE9rer des d\xE9finitions",auto_layout:"Disposition auto du canevas",enable_auto_layout:"Activer la disposition automatique",enable_auto_layout_desc:"Normaliser automatiquement la disposition apr\xE8s ajout/mise \xE0 jour/suppression et changements de groupe",card_size:"Taille de carte",card_size_desc:"Taille de carte par d\xE9faut (Largeur \xD7 Hauteur, par d\xE9faut : 260 \xD7 120)",grid_gaps:"Espacement de la grille",grid_gaps_desc:"Espacement horizontal/vertical pour la grille de gauche",left_padding:"Marge gauche et X min",left_padding_desc:"Marge gauche depuis le groupe Mastered et X minimale pour la zone gauche",columns_auto:"Colonnes auto",columns_auto_desc:"D\xE9terminer automatiquement les colonnes (limit\xE9 par le max)",columns:"Colonnes fixes / Colonnes max",columns_desc:"Sp\xE9cifier colonnes fixes et max (quand auto est d\xE9sactiv\xE9)",group_inner_layout:"Disposition interne du groupe",group_inner_layout_desc:"Marge interne, espacements et colonnes pour les n\u0153uds dans les groupes",highlight_scope:"Port\xE9e de surbrillance",highlight_mode:"Mode de surbrillance",highlight_mode_desc:"Choisir le mode de port\xE9e pour la surbrillance des mots",mode_all:"Tous les fichiers",mode_exclude:"Exclure les chemins sp\xE9cifi\xE9s",mode_include:"Uniquement les chemins sp\xE9cifi\xE9s",highlight_paths:"Chemins de fichiers",highlight_paths_desc:"S\xE9parer plusieurs chemins par des virgules, prend en charge les chemins de dossiers (y compris les sous-dossiers)",highlight_paths_placeholder:"ex : Archive, Templates, Private/Diary",file_node_parse_mode:"Mode d'analyse de noeud de fichier",file_node_parse_mode_desc:"Choisir comment analyser les cartes de fichiers dans Canvas",mode_filename:"Nom de fichier uniquement",mode_content:"Contenu de fichier uniquement",mode_filename_with_alias:"Nom de fichier comme mot, contenu comme alias"},sidebar:{title:"HiWords",empty_state:"Aucun mot trouv\xE9. Ajoutez des mots \xE0 vos livres pour les voir ici.",source_prefix:"De : ",found:"Trouv\xE9s",words:"mots",no_definition:"Aucune d\xE9finition disponible.",vocabulary_book:"Mots",mastered:"Ma\xEEtris\xE9s",no_learning_words:"Aucun mot \xE0 apprendre",no_mastered_words:"Aucun mot ma\xEEtris\xE9"},commands:{refresh_vocabulary:"Actualiser le vocabulaire",add_word:"HiWords : Ajouter un mot",edit_word:"HiWords : \xC9diter un mot",show_sidebar:"Afficher la barre lat\xE9rale HiWords",add_selected_word:"Ajouter un mot"},notices:{vocabulary_refreshed:"Livres actualis\xE9s",word_added:"Mot ajout\xE9 au livre",word_exists:"Le mot existe d\xE9j\xE0 dans le livre",error_adding_word:"Erreur lors de l'ajout du mot au livre",select_book_required:"Veuillez s\xE9lectionner un livre de mots",adding_word:"Ajout du mot au livre...",updating_word:"Mise \xE0 jour du mot...",word_added_success:'Le mot "{0}" a \xE9t\xE9 ajout\xE9 avec succ\xE8s',word_updated_success:'Le mot "{0}" a \xE9t\xE9 mis \xE0 jour avec succ\xE8s',add_word_failed:"\xC9chec de l'ajout du mot, v\xE9rifiez le fichier du livre",update_word_failed:"\xC9chec de la mise \xE0 jour, v\xE9rifiez le fichier du livre",error_processing_word:"Erreur lors du traitement du mot",no_canvas_files:"Aucun fichier Canvas trouv\xE9",book_already_exists:"Ce livre existe d\xE9j\xE0",invalid_canvas_file:"Fichier Canvas invalide",book_added:"Livre ajout\xE9 : {0}",book_reloaded:"Livre recharg\xE9 : {0}",book_removed:"Livre supprim\xE9 : {0}",deleting_word:"Suppression du mot...",word_deleted:"Mot supprim\xE9",delete_word_failed:"\xC9chec de la suppression du mot, v\xE9rifiez le fichier du livre",error_deleting_word:"Une erreur est survenue lors de la suppression du mot",mastered_feature_disabled:"La fonction ma\xEEtris\xE9 n'est pas activ\xE9e",update_word_status_failed:"\xC9chec de la mise \xE0 jour du statut du mot",move_to_mastered_group_failed:"\xC9chec du d\xE9placement vers le groupe ma\xEEtris\xE9",word_marked_as_mastered:'"{0}" marqu\xE9 comme ma\xEEtris\xE9',mark_mastered_failed:"\xC9chec du marquage, veuillez r\xE9essayer",remove_from_mastered_group_failed:"\xC9chec du retrait du groupe ma\xEEtris\xE9",word_unmarked_as_mastered:'"{0}" retir\xE9 du statut ma\xEEtris\xE9',no_text_selected:"Veuillez d'abord s\xE9lectionner un mot \xE0 ajouter",word_required:"Veuillez entrer un mot",unmark_mastered_failed:"\xC9chec de la suppression de la marque, veuillez r\xE9essayer",batch_marked_success:"{0} mots marqu\xE9s comme ma\xEEtris\xE9s avec succ\xE8s",book_path_updated:"Chemin du livre mis \xE0 jour : {0}",new_notice:"Nouvelle notification"},modals:{auto_fill_definition:"D\xE9finir avec IA",word_label:"Mot",word_placeholder:"Entrez le mot \xE0 ajouter...",definition_label:"D\xE9finition",book_label:"Livre de mots",select_book:"S\xE9lectionnez un livre",color_label:"Couleur de la carte",color_gray:"Gris",color_red:"Rouge",color_orange:"Orange",color_yellow:"Jaune",color_green:"Vert",color_blue:"Bleu",color_purple:"Violet",aliases_label:"Alias (facultatif, s\xE9par\xE9s par des virgules)",aliases_placeholder:"ex. : doing, done, did",definition_placeholder:"Saisissez la d\xE9finition...",add_button:"Ajouter",save_button:"Enregistrer",cancel_button:"Annuler",select_canvas_file:"S\xE9lectionner le fichier du livre",delete_confirmation:`\xCAtes-vous s\xFBr de vouloir supprimer le mot "{0}" ?
Cette action est irr\xE9versible.`},actions:{expand:"D\xE9ployer",collapse:"Replier",mark_mastered:"Marquer comme ma\xEEtris\xE9",unmark_mastered:"Retirer le statut ma\xEEtris\xE9"},ai_errors:{word_empty:"Le mot ne peut pas \xEAtre vide",api_key_not_configured:"La cl\xE9 API n'est pas configur\xE9e. Veuillez la d\xE9finir dans les param\xE8tres du plugin",invalid_response:"L'API a renvoy\xE9 un format de r\xE9ponse invalide",api_key_invalid:"\u274C La cl\xE9 API est invalide ou expir\xE9e. Veuillez v\xE9rifier les param\xE8tres du plugin",rate_limit:"\u23F1\uFE0F Limite de d\xE9bit de l'API d\xE9pass\xE9e. Veuillez r\xE9essayer plus tard",server_error:"\u{1F527} Le service API est temporairement indisponible. Veuillez r\xE9essayer plus tard",network_error:"\u{1F310} \xC9chec de la connexion r\xE9seau. Veuillez v\xE9rifier vos param\xE8tres r\xE9seau",request_failed:"La requ\xEAte au dictionnaire IA a \xE9chou\xE9"}};var Je={plugin_name:"HiWords",settings:{vocabulary_books:"W\xF6rterb\xFCcher",add_vocabulary_book:"W\xF6rterbuch hinzuf\xFCgen",remove_vocabulary_book:"Entfernen",show_definition_on_hover:"Definition beim Hover anzeigen",show_definition_on_hover_desc:"Definition anzeigen, wenn der Mauszeiger \xFCber hervorgehobene W\xF6rter f\xE4hrt",enable_auto_highlight:"Automatisches Hervorheben aktivieren",enable_auto_highlight_desc:"W\xF6rter aus den W\xF6rterb\xFCchern beim Lesen automatisch hervorheben",highlight_style:"Hervorhebungsstil",highlight_style_desc:"W\xE4hlen Sie, wie W\xF6rter im Text hervorgehoben werden",style_underline:"Unterstreichen",style_background:"Hintergrund",style_bold:"Fett",style_dotted:"Gepunktete Unterstreichung",style_wavy:"Wellenf\xF6rmige Unterstreichung",save_settings:"Einstellungen speichern",no_vocabulary_books:"Noch keine W\xF6rterb\xFCcher. F\xFCgen Sie eine Canvas-Datei als W\xF6rterbuch hinzu.",path:"Pfad",reload_book:"Dieses W\xF6rterbuch neu laden",statistics:"Statistiken",total_books:"Gesamtzahl der W\xF6rterb\xFCcher: {0}",enabled_books:"Aktivierte W\xF6rterb\xFCcher: {0}",total_words:"Gesamtzahl der W\xF6rter: {0}",enable_mastered_feature:"Funktion 'Gemeistert' aktivieren",enable_mastered_feature_desc:"Gemeisterte W\xF6rter markieren, um sie nicht mehr hervorzuheben. Seitenleiste zeigt Gruppen",blur_definitions:"Inhalt verwischen",blur_definitions_desc:"Standardm\xE4\xDFig verwischen, beim Hover anzeigen. Ideal zum Erinnern vor dem Anzeigen der Antwort",tts_template:"TTS-Vorlage",tts_template_desc:"{{word}} als Platzhalter verwenden, z.B. https://dict.youdao.com/dictvoice?audio={{word}}&type=2",ai_dictionary:"KI-Assistent",ai_api_url:"API-URL",ai_api_url_desc:"API-Endpunkt (erkennt automatisch: OpenAI, Claude, Gemini)",ai_api_key:"API-Schl\xFCssel",ai_api_key_desc:"Ihr KI-API-Schl\xFCssel",ai_model:"Modell",ai_model_desc:"KI-Modellname (z.B. gpt-4o-mini, deepseek-chat)",ai_prompt:"Benutzerdefinierter Prompt",ai_prompt_desc:"{{word}} und {{sentence}} als Platzhalter verwenden. Die KI wird diesen Prompt verwenden, um Definitionen zu generieren",auto_layout:"Automatisches Canvas-Layout",enable_auto_layout:"Automatisches Layout aktivieren",enable_auto_layout_desc:"Layout nach Hinzuf\xFCgen/Aktualisieren/L\xF6schen und Gruppen\xE4nderungen automatisch normalisieren",card_size:"Kartengr\xF6\xDFe",card_size_desc:"Standard-Kartengr\xF6\xDFe (Breite \xD7 H\xF6he, Standard: 260 \xD7 120)",grid_gaps:"Gitterabst\xE4nde",grid_gaps_desc:"Horizontale/vertikale Abst\xE4nde f\xFCr das linke Gitter",left_padding:"Linker Innenabstand & min. X",left_padding_desc:"Linker Abstand zur Gruppe 'Mastered' und minimale X-Position f\xFCr den linken Bereich",columns_auto:"Automatische Spalten",columns_auto_desc:"Spalten automatisch bestimmen (begrenzt durch maximale Spalten)",columns:"Feste Spalten / Maximale Spalten",columns_desc:"Feste Spalten und Maximalspalten angeben (wirksam, wenn auto aus)",group_inner_layout:"Inneres Gruppenlayout",group_inner_layout_desc:"Innenabstand, Abst\xE4nde und Spalten f\xFCr Knoten in Gruppen",highlight_scope:"Hervorhebungsbereich",highlight_mode:"Hervorhebungsmodus",highlight_mode_desc:"W\xE4hlen Sie den Bereichsmodus f\xFCr die Wort-Hervorhebung",mode_all:"Alle Dateien",mode_exclude:"Angegebene Pfade ausschlie\xDFen",mode_include:"Nur angegebene Pfade",highlight_paths:"Dateipfade",highlight_paths_desc:"Mehrere Pfade durch Kommas trennen, unterst\xFCtzt Ordnerpfade (einschlie\xDFlich Unterordner)",highlight_paths_placeholder:"z.B.: Archive, Templates, Private/Diary",file_node_parse_mode:"Dateiknoten-Analysemodus",file_node_parse_mode_desc:"W\xE4hlen Sie, wie Dateikarten in Canvas analysiert werden",mode_filename:"Nur Dateiname",mode_content:"Nur Dateiinhalt",mode_filename_with_alias:"Dateiname als Wort, Inhalt als Alias"},sidebar:{title:"HiWords",empty_state:"Keine W\xF6rter gefunden. F\xFCgen Sie W\xF6rter zu Ihren W\xF6rterb\xFCchern hinzu, um sie hier zu sehen.",source_prefix:"Von: ",found:"Gefunden",words:"W\xF6rter",no_definition:"Keine Definition verf\xFCgbar.",vocabulary_book:"W\xF6rter",mastered:"Gemeistert",no_learning_words:"Keine zu lernenden W\xF6rter",no_mastered_words:"Keine gemeisterten W\xF6rter"},commands:{refresh_vocabulary:"Vokabular aktualisieren",add_word:"HiWords: Wort hinzuf\xFCgen",edit_word:"HiWords: Wort bearbeiten",show_sidebar:"HiWords-Seitenleiste anzeigen",add_selected_word:"Wort hinzuf\xFCgen"},notices:{vocabulary_refreshed:"W\xF6rterb\xFCcher aktualisiert",word_added:"Wort zum W\xF6rterbuch hinzugef\xFCgt",word_exists:"Wort existiert bereits im W\xF6rterbuch",error_adding_word:"Fehler beim Hinzuf\xFCgen des Wortes zum W\xF6rterbuch",select_book_required:"Bitte w\xE4hlen Sie ein W\xF6rterbuch aus",adding_word:"Wort wird zum W\xF6rterbuch hinzugef\xFCgt...",updating_word:"Wort wird aktualisiert...",word_added_success:'Wort "{0}" erfolgreich hinzugef\xFCgt',word_updated_success:'Wort "{0}" erfolgreich aktualisiert',add_word_failed:"Hinzuf\xFCgen des Wortes fehlgeschlagen, pr\xFCfen Sie die Datei",update_word_failed:"Aktualisieren des Wortes fehlgeschlagen, pr\xFCfen Sie die Datei",error_processing_word:"Fehler bei der Verarbeitung des Wortes",no_canvas_files:"Keine Canvas-Dateien gefunden",book_already_exists:"Dieses W\xF6rterbuch existiert bereits",invalid_canvas_file:"Ung\xFCltige Canvas-Datei",book_added:"W\xF6rterbuch hinzugef\xFCgt: {0}",book_reloaded:"W\xF6rterbuch neu geladen: {0}",book_removed:"W\xF6rterbuch entfernt: {0}",deleting_word:"Wort wird gel\xF6scht...",word_deleted:"Wort gel\xF6scht",delete_word_failed:"L\xF6schen des Wortes fehlgeschlagen, pr\xFCfen Sie die Datei",error_deleting_word:"Beim L\xF6schen des Wortes ist ein Fehler aufgetreten",mastered_feature_disabled:"Funktion 'Gemeistert' ist nicht aktiviert",update_word_status_failed:"Aktualisieren des Wortstatus fehlgeschlagen",move_to_mastered_group_failed:"Verschieben in die Gruppe 'Gemeistert' fehlgeschlagen",word_marked_as_mastered:'"{0}" als gemeistert markiert',mark_mastered_failed:"Als gemeistert markieren fehlgeschlagen, bitte erneut versuchen",remove_from_mastered_group_failed:"Entfernen aus der Gruppe 'Gemeistert' fehlgeschlagen",word_unmarked_as_mastered:'"{0}" nicht mehr als gemeistert markiert',no_text_selected:"Bitte w\xE4hlen Sie zuerst ein Wort aus",word_required:"Bitte geben Sie ein Wort ein",unmark_mastered_failed:"Markierung konnte nicht entfernt werden, bitte erneut versuchen",batch_marked_success:"{0} W\xF6rter erfolgreich als gemeistert markiert",book_path_updated:"W\xF6rterbuchpfad aktualisiert: {0}",new_notice:"Neue Benachrichtigung"},modals:{auto_fill_definition:"KI-Definition",word_label:"Wort",word_placeholder:"Wort eingeben...",definition_label:"Definition",book_label:"W\xF6rterbuch",select_book:"W\xF6rterbuch ausw\xE4hlen",color_label:"Kartenfarbe",color_gray:"Grau",color_red:"Rot",color_orange:"Orange",color_yellow:"Gelb",color_green:"Gr\xFCn",color_blue:"Blau",color_purple:"Lila",aliases_label:"Aliasse (optional, durch Kommas getrennt)",aliases_placeholder:"z. B.: doing, done, did",definition_placeholder:"Definition eingeben...",add_button:"Hinzuf\xFCgen",save_button:"Speichern",cancel_button:"Abbrechen",select_canvas_file:"Datei des W\xF6rterbuchs ausw\xE4hlen",delete_confirmation:`M\xF6chten Sie das Wort "{0}" wirklich l\xF6schen?
Diese Aktion kann nicht r\xFCckg\xE4ngig gemacht werden.`},actions:{expand:"Erweitern",collapse:"Einklappen",mark_mastered:"Als beherrscht markieren",unmark_mastered:"Beherrschung aufheben"},ai_errors:{word_empty:"Das Wort darf nicht leer sein",api_key_not_configured:"API-Schl\xFCssel ist nicht konfiguriert. Bitte in den Plugin-Einstellungen festlegen",invalid_response:"Die API hat ein ung\xFCltiges Antwortformat zur\xFCckgegeben",api_key_invalid:"\u274C API-Schl\xFCssel ist ung\xFCltig oder abgelaufen. Bitte \xFCberpr\xFCfen Sie die Plugin-Einstellungen",rate_limit:"\u23F1\uFE0F API-Ratenlimit \xFCberschritten. Bitte versuchen Sie es sp\xE4ter erneut",server_error:"\u{1F527} API-Dienst ist vor\xFCbergehend nicht verf\xFCgbar. Bitte versuchen Sie es sp\xE4ter erneut",network_error:"\u{1F310} Netzwerkverbindung fehlgeschlagen. Bitte \xFCberpr\xFCfen Sie Ihre Netzwerkeinstellungen",request_failed:"KI-W\xF6rterbuch-Anfrage fehlgeschlagen"}};var Ye={plugin_name:"HiWords",settings:{vocabulary_books:"\u5358\u8A9E\u5E33",add_vocabulary_book:"\u5358\u8A9E\u5E33\u3092\u8FFD\u52A0",remove_vocabulary_book:"\u524A\u9664",show_definition_on_hover:"\u30DB\u30D0\u30FC\u3067\u5B9A\u7FA9\u3092\u8868\u793A",show_definition_on_hover_desc:"\u5F37\u8ABF\u8868\u793A\u3055\u308C\u305F\u5358\u8A9E\u306B\u30DE\u30A6\u30B9\u3092\u4E57\u305B\u308B\u3068\u5B9A\u7FA9\u3092\u8868\u793A\u3057\u307E\u3059",enable_auto_highlight:"\u81EA\u52D5\u30CF\u30A4\u30E9\u30A4\u30C8\u3092\u6709\u52B9\u5316",enable_auto_highlight_desc:"\u8AAD\u66F8\u4E2D\u306B\u5358\u8A9E\u5E33\u306E\u5358\u8A9E\u3092\u81EA\u52D5\u7684\u306B\u30CF\u30A4\u30E9\u30A4\u30C8\u3057\u307E\u3059",highlight_style:"\u30CF\u30A4\u30E9\u30A4\u30C8\u30B9\u30BF\u30A4\u30EB",highlight_style_desc:"\u30C6\u30AD\u30B9\u30C8\u4E2D\u306E\u5358\u8A9E\u306E\u30CF\u30A4\u30E9\u30A4\u30C8\u65B9\u6CD5\u3092\u9078\u629E",style_underline:"\u4E0B\u7DDA",style_background:"\u80CC\u666F",style_bold:"\u592A\u5B57",style_dotted:"\u70B9\u7DDA\u306E\u4E0B\u7DDA",style_wavy:"\u6CE2\u7DDA\u306E\u4E0B\u7DDA",save_settings:"\u8A2D\u5B9A\u3092\u4FDD\u5B58",no_vocabulary_books:"\u5358\u8A9E\u5E33\u304C\u307E\u3060\u3042\u308A\u307E\u305B\u3093\u3002Canvas \u30D5\u30A1\u30A4\u30EB\u3092\u5358\u8A9E\u5E33\u3068\u3057\u3066\u8FFD\u52A0\u3057\u3066\u304F\u3060\u3055\u3044\u3002",path:"\u30D1\u30B9",reload_book:"\u3053\u306E\u5358\u8A9E\u5E33\u3092\u518D\u8AAD\u307F\u8FBC\u307F",statistics:"\u7D71\u8A08",total_books:"\u5358\u8A9E\u5E33\u306E\u5408\u8A08: {0}",enabled_books:"\u6709\u52B9\u306A\u5358\u8A9E\u5E33: {0}",total_words:"\u5358\u8A9E\u306E\u5408\u8A08: {0}",enable_mastered_feature:"\u7FD2\u5F97\u6E08\u307F\u6A5F\u80FD\u3092\u6709\u52B9\u5316",enable_mastered_feature_desc:"\u7FD2\u5F97\u6E08\u307F\u306E\u5358\u8A9E\u3092\u30DE\u30FC\u30AF\u3057\u3066\u30CF\u30A4\u30E9\u30A4\u30C8\u3092\u505C\u6B62\u3002\u30B5\u30A4\u30C9\u30D0\u30FC\u306B\u30B0\u30EB\u30FC\u30D7\u8868\u793A",blur_definitions:"\u30B3\u30F3\u30C6\u30F3\u30C4\u3092\u307C\u304B\u3059",blur_definitions_desc:"\u30C7\u30D5\u30A9\u30EB\u30C8\u3067\u307C\u304B\u3057\u3001\u30DB\u30D0\u30FC\u6642\u306B\u8868\u793A\u3002\u5B66\u7FD2\u6642\u306B\u7B54\u3048\u3092\u898B\u308B\u524D\u306B\u601D\u3044\u51FA\u3059\u306E\u306B\u6700\u9069",tts_template:"TTS\u30C6\u30F3\u30D7\u30EC\u30FC\u30C8",tts_template_desc:"{{word}}\u3092\u30D7\u30EC\u30FC\u30B9\u30DB\u30EB\u30C0\u30FC\u3068\u3057\u3066\u4F7F\u7528\u3001\u4F8B\uFF1Ahttps://dict.youdao.com/dictvoice?audio={{word}}&type=2",ai_dictionary:"AI\u30A2\u30B7\u30B9\u30BF\u30F3\u30C8",ai_api_url:"API URL",ai_api_url_desc:"API\u30A8\u30F3\u30C9\u30DD\u30A4\u30F3\u30C8\uFF08\u81EA\u52D5\u691C\u51FA\uFF1AOpenAI\u3001Claude\u3001Gemini\uFF09",ai_api_key:"API\u30AD\u30FC",ai_api_key_desc:"\u3042\u306A\u305F\u306EAI API\u30AD\u30FC",ai_model:"\u30E2\u30C7\u30EB",ai_model_desc:"AI\u30E2\u30C7\u30EB\u540D\uFF08\u4F8B\uFF1Agpt-4o-mini\u3001deepseek-chat\uFF09",ai_prompt:"\u30AB\u30B9\u30BF\u30E0\u30D7\u30ED\u30F3\u30D7\u30C8",ai_prompt_desc:"{{word}}\u3068{{sentence}}\u3092\u30D7\u30EC\u30FC\u30B9\u30DB\u30EB\u30C0\u30FC\u3068\u3057\u3066\u4F7F\u7528\u3002AI\u306F\u3053\u306E\u30D7\u30ED\u30F3\u30D7\u30C8\u3092\u4F7F\u7528\u3057\u3066\u5B9A\u7FA9\u3092\u751F\u6210\u3057\u307E\u3059",auto_layout:"\u30AD\u30E3\u30F3\u30D0\u30B9\u81EA\u52D5\u30EC\u30A4\u30A2\u30A6\u30C8",enable_auto_layout:"\u81EA\u52D5\u30EC\u30A4\u30A2\u30A6\u30C8\u3092\u6709\u52B9\u5316",enable_auto_layout_desc:"\u8FFD\u52A0/\u66F4\u65B0/\u524A\u9664\u304A\u3088\u3073\u30B0\u30EB\u30FC\u30D7\u5909\u66F4\u5F8C\u306B\u30EC\u30A4\u30A2\u30A6\u30C8\u3092\u81EA\u52D5\u6B63\u898F\u5316",card_size:"\u30AB\u30FC\u30C9\u30B5\u30A4\u30BA",card_size_desc:"\u30C7\u30D5\u30A9\u30EB\u30C8\u30AB\u30FC\u30C9\u30B5\u30A4\u30BA\uFF08\u5E45 \xD7 \u9AD8\u3055\u3001\u30C7\u30D5\u30A9\u30EB\u30C8\uFF1A260 \xD7 120\uFF09",grid_gaps:"\u30B0\u30EA\u30C3\u30C9\u9593\u9694",grid_gaps_desc:"\u5DE6\u30B0\u30EA\u30C3\u30C9\u306E\u6C34\u5E73/\u5782\u76F4\u9593\u9694",left_padding:"\u5DE6\u4F59\u767D\u3068\u6700\u5C0F X",left_padding_desc:"Mastered \u30B0\u30EB\u30FC\u30D7\u304B\u3089\u306E\u5DE6\u4F59\u767D\u3068\u5DE6\u30A8\u30EA\u30A2\u306E\u6700\u5C0F X",columns_auto:"\u81EA\u52D5\u30AB\u30E9\u30E0",columns_auto_desc:"\u30AB\u30E9\u30E0\u6570\u3092\u81EA\u52D5\u6C7A\u5B9A\uFF08\u6700\u5927\u30AB\u30E9\u30E0\u6570\u3067\u5236\u9650\uFF09",columns:"\u56FA\u5B9A\u30AB\u30E9\u30E0 / \u6700\u5927\u30AB\u30E9\u30E0",columns_desc:"\u56FA\u5B9A\u30AB\u30E9\u30E0\u3068\u6700\u5927\u30AB\u30E9\u30E0\u3092\u6307\u5B9A\uFF08\u81EA\u52D5\u304C\u30AA\u30D5\u306E\u6642\u306B\u6709\u52B9\uFF09",group_inner_layout:"\u30B0\u30EB\u30FC\u30D7\u5185\u90E8\u30EC\u30A4\u30A2\u30A6\u30C8",group_inner_layout_desc:"\u30B0\u30EB\u30FC\u30D7\u5185\u30CE\u30FC\u30C9\u306E\u5185\u5074\u4F59\u767D\u3001\u9593\u9694\u3001\u30AB\u30E9\u30E0\u8A2D\u5B9A",highlight_scope:"\u30CF\u30A4\u30E9\u30A4\u30C8\u7BC4\u56F2",highlight_mode:"\u30CF\u30A4\u30E9\u30A4\u30C8\u30E2\u30FC\u30C9",highlight_mode_desc:"\u5358\u8A9E\u30CF\u30A4\u30E9\u30A4\u30C8\u306E\u7BC4\u56F2\u30E2\u30FC\u30C9\u3092\u9078\u629E",mode_all:"\u3059\u3079\u3066\u306E\u30D5\u30A1\u30A4\u30EB",mode_exclude:"\u6307\u5B9A\u30D1\u30B9\u3092\u9664\u5916",mode_include:"\u6307\u5B9A\u30D1\u30B9\u306E\u307F",highlight_paths:"\u30D5\u30A1\u30A4\u30EB\u30D1\u30B9",highlight_paths_desc:"\u8907\u6570\u306E\u30D1\u30B9\u3092\u30AB\u30F3\u30DE\u3067\u533A\u5207\u308A\u3001\u30D5\u30A9\u30EB\u30C0\u30D1\u30B9\u3092\u30B5\u30DD\u30FC\u30C8\uFF08\u30B5\u30D6\u30D5\u30A9\u30EB\u30C0\u3092\u542B\u3080\uFF09",highlight_paths_placeholder:"\u4F8B\uFF1AArchive, Templates, Private/Diary",file_node_parse_mode:"\u30D5\u30A1\u30A4\u30EB\u30CE\u30FC\u30C9\u89E3\u6790\u30E2\u30FC\u30C9",file_node_parse_mode_desc:"Canvas \u5185\u306E\u30D5\u30A1\u30A4\u30EB\u30AB\u30FC\u30C9\u306E\u89E3\u6790\u65B9\u6CD5\u3092\u9078\u629E",mode_filename:"\u30D5\u30A1\u30A4\u30EB\u540D\u306E\u307F",mode_content:"\u30D5\u30A1\u30A4\u30EB\u5185\u5BB9\u306E\u307F",mode_filename_with_alias:"\u30D5\u30A1\u30A4\u30EB\u540D\u3092\u5358\u8A9E\u3001\u5185\u5BB9\u3092\u30A8\u30A4\u30EA\u30A2\u30B9\u3068\u3057\u3066"},sidebar:{title:"HiWords",empty_state:"\u5358\u8A9E\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3002\u5358\u8A9E\u5E33\u306B\u8FFD\u52A0\u3059\u308B\u3068\u3053\u3053\u306B\u8868\u793A\u3055\u308C\u307E\u3059\u3002",source_prefix:"\u51FA\u5178: ",found:"\u898B\u3064\u304B\u3063\u305F",words:"\u5358\u8A9E",no_definition:"\u5B9A\u7FA9\u306F\u3042\u308A\u307E\u305B\u3093\u3002",vocabulary_book:"\u5358\u8A9E",mastered:"\u7FD2\u5F97\u6E08\u307F",no_learning_words:"\u5B66\u7FD2\u3059\u308B\u5358\u8A9E\u306F\u3042\u308A\u307E\u305B\u3093",no_mastered_words:"\u7FD2\u5F97\u6E08\u307F\u306E\u5358\u8A9E\u306F\u3042\u308A\u307E\u305B\u3093"},commands:{refresh_vocabulary:"\u5358\u8A9E\u5E33\u3092\u66F4\u65B0",add_word:"HiWords: \u5358\u8A9E\u3092\u8FFD\u52A0",edit_word:"HiWords: \u5358\u8A9E\u3092\u7DE8\u96C6",show_sidebar:"HiWords \u30B5\u30A4\u30C9\u30D0\u30FC\u3092\u8868\u793A",add_selected_word:"\u5358\u8A9E\u3092\u8FFD\u52A0"},notices:{vocabulary_refreshed:"\u5358\u8A9E\u5E33\u3092\u66F4\u65B0\u3057\u307E\u3057\u305F",word_added:"\u5358\u8A9E\u3092\u5358\u8A9E\u5E33\u306B\u8FFD\u52A0\u3057\u307E\u3057\u305F",word_exists:"\u5358\u8A9E\u306F\u3059\u3067\u306B\u5358\u8A9E\u5E33\u306B\u5B58\u5728\u3057\u307E\u3059",error_adding_word:"\u5358\u8A9E\u306E\u8FFD\u52A0\u4E2D\u306B\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F",select_book_required:"\u5358\u8A9E\u5E33\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044",adding_word:"\u5358\u8A9E\u3092\u8FFD\u52A0\u4E2D...",updating_word:"\u5358\u8A9E\u3092\u66F4\u65B0\u4E2D...",word_added_success:'\u5358\u8A9E "{0}" \u3092\u8FFD\u52A0\u3057\u307E\u3057\u305F',word_updated_success:'\u5358\u8A9E "{0}" \u3092\u66F4\u65B0\u3057\u307E\u3057\u305F',add_word_failed:"\u5358\u8A9E\u3092\u8FFD\u52A0\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F\u3002\u5358\u8A9E\u5E33\u30D5\u30A1\u30A4\u30EB\u3092\u78BA\u8A8D\u3057\u3066\u304F\u3060\u3055\u3044",update_word_failed:"\u5358\u8A9E\u3092\u66F4\u65B0\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F\u3002\u5358\u8A9E\u5E33\u30D5\u30A1\u30A4\u30EB\u3092\u78BA\u8A8D\u3057\u3066\u304F\u3060\u3055\u3044",error_processing_word:"\u5358\u8A9E\u306E\u51E6\u7406\u4E2D\u306B\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F",no_canvas_files:"Canvas \u30D5\u30A1\u30A4\u30EB\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093",book_already_exists:"\u3053\u306E\u5358\u8A9E\u5E33\u306F\u65E2\u306B\u5B58\u5728\u3057\u307E\u3059",invalid_canvas_file:"\u7121\u52B9\u306A Canvas \u30D5\u30A1\u30A4\u30EB\u3067\u3059",book_added:"\u5358\u8A9E\u5E33\u3092\u8FFD\u52A0\u3057\u307E\u3057\u305F: {0}",book_reloaded:"\u5358\u8A9E\u5E33\u3092\u518D\u8AAD\u307F\u8FBC\u307F\u3057\u307E\u3057\u305F: {0}",book_removed:"\u5358\u8A9E\u5E33\u3092\u524A\u9664\u3057\u307E\u3057\u305F: {0}",deleting_word:"\u5358\u8A9E\u3092\u524A\u9664\u4E2D...",word_deleted:"\u5358\u8A9E\u3092\u524A\u9664\u3057\u307E\u3057\u305F",delete_word_failed:"\u5358\u8A9E\u3092\u524A\u9664\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F\u3002\u30D5\u30A1\u30A4\u30EB\u3092\u78BA\u8A8D\u3057\u3066\u304F\u3060\u3055\u3044",error_deleting_word:"\u524A\u9664\u4E2D\u306B\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F",mastered_feature_disabled:"\u7FD2\u5F97\u6E08\u307F\u6A5F\u80FD\u306F\u6709\u52B9\u306B\u306A\u3063\u3066\u3044\u307E\u305B\u3093",update_word_status_failed:"\u5358\u8A9E\u306E\u30B9\u30C6\u30FC\u30BF\u30B9\u66F4\u65B0\u306B\u5931\u6557\u3057\u307E\u3057\u305F",move_to_mastered_group_failed:"\u7FD2\u5F97\u6E08\u307F\u30B0\u30EB\u30FC\u30D7\u3078\u306E\u79FB\u52D5\u306B\u5931\u6557\u3057\u307E\u3057\u305F",word_marked_as_mastered:'"{0}" \u3092\u7FD2\u5F97\u6E08\u307F\u306B\u8A2D\u5B9A\u3057\u307E\u3057\u305F',mark_mastered_failed:"\u30DE\u30FC\u30AF\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002\u3082\u3046\u4E00\u5EA6\u8A66\u3057\u3066\u304F\u3060\u3055\u3044",remove_from_mastered_group_failed:"\u7FD2\u5F97\u6E08\u307F\u30B0\u30EB\u30FC\u30D7\u304B\u3089\u306E\u524A\u9664\u306B\u5931\u6557\u3057\u307E\u3057\u305F",word_unmarked_as_mastered:'"{0}" \u306E\u30DE\u30B9\u30BF\u30FC\u6E08\u307F\u30DE\u30FC\u30AF\u3092\u89E3\u9664\u3057\u307E\u3057\u305F',no_text_selected:"\u8FFD\u52A0\u3059\u308B\u5358\u8A9E\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044",word_required:"\u5358\u8A9E\u3092\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044",unmark_mastered_failed:"\u30DE\u30FC\u30AF\u89E3\u9664\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002\u3082\u3046\u4E00\u5EA6\u8A66\u3057\u3066\u304F\u3060\u3055\u3044",batch_marked_success:"{0}\u500B\u306E\u5358\u8A9E\u3092\u7FD2\u5F97\u6E08\u307F\u3068\u3057\u3066\u30DE\u30FC\u30AF\u3057\u307E\u3057\u305F",book_path_updated:"\u5358\u8A9E\u5E33\u306E\u30D1\u30B9\u304C\u66F4\u65B0\u3055\u308C\u307E\u3057\u305F: {0}",new_notice:"\u65B0\u3057\u3044\u901A\u77E5"},modals:{auto_fill_definition:"AI\u5B9A\u7FA9",word_label:"\u5358\u8A9E",word_placeholder:"\u8FFD\u52A0\u3059\u308B\u5358\u8A9E\u3092\u5165\u529B...",definition_label:"\u5B9A\u7FA9",book_label:"\u5358\u8A9E\u5E33",select_book:"\u5358\u8A9E\u5E33\u3092\u9078\u629E",color_label:"\u30AB\u30FC\u30C9\u306E\u8272",color_gray:"\u30B0\u30EC\u30FC",color_red:"\u8D64",color_orange:"\u30AA\u30EC\u30F3\u30B8",color_yellow:"\u9EC4\u8272",color_green:"\u7DD1",color_blue:"\u9752",color_purple:"\u7D2B",aliases_label:"\u5225\u540D\uFF08\u4EFB\u610F\u3001\u30AB\u30F3\u30DE\u533A\u5207\u308A\uFF09",aliases_placeholder:"\u4F8B: doing, done, did",definition_placeholder:"\u5B9A\u7FA9\u3092\u5165\u529B...",add_button:"\u8FFD\u52A0",save_button:"\u4FDD\u5B58",cancel_button:"\u30AD\u30E3\u30F3\u30BB\u30EB",select_canvas_file:"\u5358\u8A9E\u5E33\u30D5\u30A1\u30A4\u30EB\u3092\u9078\u629E",delete_confirmation:`\u5358\u8A9E "{0}" \u3092\u524A\u9664\u3057\u3066\u3082\u3088\u308D\u3057\u3044\u3067\u3059\u304B\uFF1F
\u3053\u306E\u64CD\u4F5C\u306F\u5143\u306B\u623B\u305B\u307E\u305B\u3093\u3002`},actions:{expand:"\u5C55\u958B",collapse:"\u6298\u308A\u305F\u305F\u3080",mark_mastered:"\u7FD2\u5F97\u6E08\u307F\u306B\u3059\u308B",unmark_mastered:"\u7FD2\u5F97\u6E08\u307F\u3092\u89E3\u9664"},ai_errors:{word_empty:"\u5358\u8A9E\u3092\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044",api_key_not_configured:"API\u30AD\u30FC\u304C\u8A2D\u5B9A\u3055\u308C\u3066\u3044\u307E\u305B\u3093\u3002\u30D7\u30E9\u30B0\u30A4\u30F3\u8A2D\u5B9A\u3067\u8A2D\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044",invalid_response:"API\u304C\u7121\u52B9\u306A\u5FDC\u7B54\u5F62\u5F0F\u3092\u8FD4\u3057\u307E\u3057\u305F",api_key_invalid:"\u274C API\u30AD\u30FC\u304C\u7121\u52B9\u307E\u305F\u306F\u671F\u9650\u5207\u308C\u3067\u3059\u3002\u30D7\u30E9\u30B0\u30A4\u30F3\u8A2D\u5B9A\u3092\u78BA\u8A8D\u3057\u3066\u304F\u3060\u3055\u3044",rate_limit:"\u23F1\uFE0F API\u30EC\u30FC\u30C8\u5236\u9650\u3092\u8D85\u3048\u307E\u3057\u305F\u3002\u5F8C\u3067\u3082\u3046\u4E00\u5EA6\u304A\u8A66\u3057\u304F\u3060\u3055\u3044",server_error:"\u{1F527} API\u30B5\u30FC\u30D3\u30B9\u304C\u4E00\u6642\u7684\u306B\u5229\u7528\u3067\u304D\u307E\u305B\u3093\u3002\u5F8C\u3067\u3082\u3046\u4E00\u5EA6\u304A\u8A66\u3057\u304F\u3060\u3055\u3044",network_error:"\u{1F310} \u30CD\u30C3\u30C8\u30EF\u30FC\u30AF\u63A5\u7D9A\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002\u30CD\u30C3\u30C8\u30EF\u30FC\u30AF\u8A2D\u5B9A\u3092\u78BA\u8A8D\u3057\u3066\u304F\u3060\u3055\u3044",request_failed:"AI\u8F9E\u66F8\u30EA\u30AF\u30A8\u30B9\u30C8\u304C\u5931\u6557\u3057\u307E\u3057\u305F"}};var wt={en:$e,zh:je,es:Ke,fr:Xe,de:Je,ja:Ye},Ce=class l{constructor(){this.app=null}static getInstance(){return l.instance||(l.instance=new l),l.instance}setApp(e){this.app=e}getCurrentLocale(){let e=(0,Qe.getLanguage)();return e.startsWith("zh")?"zh":e.startsWith("es")?"es":e.startsWith("fr")?"fr":e.startsWith("de")?"de":e.startsWith("ja")||e.startsWith("jp")?"ja":"en"}t(e){let t=this.getCurrentLocale(),i=wt[t],r=e.split("."),o=i;for(let a of r)if(o&&o[a]!==void 0)o=o[a];else return console.warn(`\u7FFB\u8BD1\u952E ${e} \u4E0D\u5B58\u5728\u4E8E ${t} \u8BED\u8A00\u5305\u4E2D`),e;return o}},Te=Ce.getInstance(),d=l=>Te.t(l);var oe=class{constructor(e,t){this.plugin=e,this.vocabularyManager=t,this.masteredGroupManager=new ie(e.app,e.settings)}updateSettings(){this.masteredGroupManager.updateSettings(this.plugin.settings)}get isEnabled(){return this.plugin.settings.enableMasteredFeature}async markWordAsMastered(e,t,i){var r;if(!this.isEnabled)return new D.Notice(d("notices.mastered_feature_disabled")),!1;try{let o=(r=this.plugin.settings.masteredDetection)!=null?r:"group";if(!await this.updateWordMasteredStatus(e,t,!0))return new D.Notice(d("notices.update_word_status_failed")),!1;if(o==="group"){if(!await this.masteredGroupManager.moveToMasteredGroup(e,t))return await this.updateWordMasteredStatus(e,t,!1),new D.Notice(d("notices.move_to_mastered_group_failed")),!1}else if(!await this.vocabularyManager.setNodeColor(e,t,4))return await this.updateWordMasteredStatus(e,t,!1),new D.Notice(d("notices.update_word_status_failed")),!1;return this.plugin.refreshHighlighter(),this.plugin.app.workspace.trigger("hi-words:mastered-changed"),new D.Notice(d("notices.word_marked_as_mastered").replace("{0}",i)),!0}catch(o){return console.error("\u6807\u8BB0\u5DF2\u638C\u63E1\u5931\u8D25:",o),new D.Notice(d("notices.mark_mastered_failed")),!1}}async unmarkWordAsMastered(e,t,i){var r;if(!this.isEnabled)return new D.Notice(d("notices.mastered_feature_disabled")),!1;try{let o=(r=this.plugin.settings.masteredDetection)!=null?r:"group";if(!await this.updateWordMasteredStatus(e,t,!1))return new D.Notice(d("notices.update_word_status_failed")),!1;if(o==="group"){if(!await this.masteredGroupManager.removeFromMasteredGroup(e,t))return await this.updateWordMasteredStatus(e,t,!0),new D.Notice(d("notices.remove_from_mastered_group_failed")),!1}else if(!await this.vocabularyManager.setNodeColor(e,t,void 0))return await this.updateWordMasteredStatus(e,t,!0),new D.Notice(d("notices.update_word_status_failed")),!1;return this.plugin.refreshHighlighter(),this.plugin.app.workspace.trigger("hi-words:mastered-changed"),new D.Notice(d("notices.word_unmarked_as_mastered").replace("{0}",i)),!0}catch(o){return console.error("\u53D6\u6D88\u5DF2\u638C\u63E1\u6807\u8BB0\u5931\u8D25:",o),new D.Notice(d("notices.unmark_mastered_failed")),!1}}async isWordMastered(e,t){if(!this.isEnabled)return!1;try{let i=await this.vocabularyManager.getWordDefinitionByNodeId(e,t);return(i==null?void 0:i.mastered)===!0}catch(i){return console.error("\u68C0\u67E5\u5355\u8BCD\u638C\u63E1\u72B6\u6001\u5931\u8D25:",i),!1}}async getMasteredWords(e){if(!this.isEnabled)return[];try{return(await this.vocabularyManager.getAllWordDefinitions()).filter(i=>!(!i.mastered||e&&i.source!==e))}catch(t){return console.error("\u83B7\u53D6\u5DF2\u638C\u63E1\u5355\u8BCD\u5217\u8868\u5931\u8D25:",t),[]}}async getMasteredStats(){if(!this.isEnabled)return{totalMastered:0,totalWords:0,masteredPercentage:0,byBook:{}};try{let e=await this.vocabularyManager.getAllWordDefinitions(),t=e.filter(r=>r.mastered),i={};return e.forEach(r=>{i[r.source]||(i[r.source]={mastered:0,total:0}),i[r.source].total++,r.mastered&&i[r.source].mastered++}),{totalMastered:t.length,totalWords:e.length,masteredPercentage:e.length>0?t.length/e.length*100:0,byBook:i}}catch(e){return console.error("\u83B7\u53D6\u5DF2\u638C\u63E1\u7EDF\u8BA1\u4FE1\u606F\u5931\u8D25:",e),{totalMastered:0,totalWords:0,masteredPercentage:0,byBook:{}}}}async batchMarkAsMastered(e){if(!this.isEnabled)return 0;let t=0;for(let i of e)await this.markWordAsMastered(i.bookPath,i.nodeId,i.word)&&t++;return t>0&&new D.Notice(d("notices.batch_marked_success").replace("{0}",t.toString())),t}async updateWordMasteredStatus(e,t,i){try{let r=await this.vocabularyManager.getWordDefinitionByNodeId(e,t);return r?(r.mastered=i,await this.vocabularyManager.updateWordDefinition(e,t,r),!0):(console.error(`\u672A\u627E\u5230\u5355\u8BCD\u5B9A\u4E49: ${t}`),!1)}catch(r){return console.error("\u66F4\u65B0\u5355\u8BCD\u638C\u63E1\u72B6\u6001\u5931\u8D25:",r),!1}}async syncMasteredStatus(e){var t;if(this.isEnabled)try{let i=await this.vocabularyManager.getWordDefinitionsByBook(e),r=(t=this.plugin.settings.masteredDetection)!=null?t:"group";for(let o of i)if(r==="group"){let a=await this.masteredGroupManager.isNodeInMasteredGroup(e,o.nodeId);o.mastered&&!a?await this.masteredGroupManager.moveToMasteredGroup(e,o.nodeId):!o.mastered&&a&&await this.masteredGroupManager.removeFromMasteredGroup(e,o.nodeId)}else o.mastered?await this.vocabularyManager.setNodeColor(e,o.nodeId,4):await this.vocabularyManager.setNodeColor(e,o.nodeId,void 0)}catch(i){console.error("\u540C\u6B65\u5DF2\u638C\u63E1\u72B6\u6001\u5931\u8D25:",i)}}};var $=require("@codemirror/state"),I=require("@codemirror/view"),Ze=require("obsidian");var yt=300,et=$.StateEffect.define(),Se=class l{constructor(){this.highlighters=new Set}static getInstance(){return l.instance||(l.instance=new l),l.instance}register(e){this.highlighters.add(e)}unregister(e){this.highlighters.delete(e)}refreshAll(){this.highlighters.forEach(e=>{try{e.forceUpdate()}catch(t){console.error("\u5237\u65B0\u9AD8\u4EAE\u5668\u5931\u8D25:",t)}})}clear(){this.highlighters.clear()}},U=Se.getInstance(),kt=$.StateField.define({create(){return I.Decoration.none},update(l,e){for(let t of e.effects)if(t.is(et))return I.Decoration.none;return l},provide:l=>I.EditorView.decorations.from(l)}),ge=class{constructor(e,t,i){this.patternDefinitions=[];this.debounceTimer=null;this.lastRanges=[];this.cachedMatches=new Map;this.editorView=e,this.vocabularyManager=t,this.shouldHighlightFile=i,this.wordTrie=new R,this.buildWordTrie(),this.decorations=this.buildDecorations(e),U.register(this)}buildWordTrie(){this.wordTrie.clear(),this.patternDefinitions=[];let e=this.vocabularyManager.getAllWordsForHighlight();for(let t of e){let i=this.vocabularyManager.getDefinition(t);i&&(i.isPattern?this.patternDefinitions.push(i):this.wordTrie.addWord(t,i))}}update(e){e.docChanged?(this.cachedMatches.clear(),this.decorations=this.buildDecorations(e.view)):(e.viewportChanged||e.focusChanged)&&this.debouncedUpdate(e.view)}forceUpdate(){this.buildWordTrie(),this.cachedMatches.clear(),this.decorations=this.buildDecorations(this.editorView),this.editorView.dispatch({effects:et.of(!0)})}debouncedUpdate(e){this.debounceTimer&&window.clearTimeout(this.debounceTimer),this.debounceTimer=window.setTimeout(()=>{this.decorations=this.buildDecorations(e),this.debounceTimer=null},yt)}buildDecorations(e){var u;if(!this.vocabularyManager.getSettings().enableAutoHighlight)return I.Decoration.none;if(this.shouldHighlightFile){let h=e.state.field(Ze.editorViewField);if((u=h==null?void 0:h.file)!=null&&u.path&&!this.shouldHighlightFile(h.file.path))return I.Decoration.none}let i=new $.RangeSetBuilder,r=[],o=e.visibleRanges,a=this.haveRangesChanged(o),s=o.map(h=>`${h.from}-${h.to}`).join(",");if(!a&&this.cachedMatches.has(s)){let h=this.cachedMatches.get(s);return this.applyDecorations(i,h),i.finish()}this.lastRanges=o.map(h=>({from:h.from,to:h.to}));for(let{from:h,to:c}of e.visibleRanges){let g=e.state.sliceDoc(h,c);r.push(...this.findWordMatches(g,h))}r.sort((h,c)=>h.from-c.from);let n=this.removeOverlaps(r);return this.cachedMatches.set(s,n),this.applyDecorations(i,n),i.finish()}applyDecorations(e,t){let i=this.vocabularyManager.getSettings().highlightStyle||"underline";t.forEach(r=>{let o=F(r.definition.color,"var(--color-base-60)");r.segments&&r.segments.length>0?r.segments.forEach(a=>{e.add(a.from,a.to,I.Decoration.mark({class:"hi-words-highlight",attributes:{"data-word":r.word,"data-definition":r.definition.definition,"data-color":o,"data-style":i,style:`--word-highlight-color: ${o};`}}))}):e.add(r.from,r.to,I.Decoration.mark({class:"hi-words-highlight",attributes:{"data-word":r.word,"data-definition":r.definition.definition,"data-color":o,"data-style":i,style:`--word-highlight-color: ${o};`}}))})}haveRangesChanged(e){if(this.lastRanges.length!==e.length)return!0;for(let t=0;t<e.length;t++)if(e[t].from!==this.lastRanges[t].from||e[t].to!==this.lastRanges[t].to)return!0;return!1}findWordMatches(e,t){let i=[];try{let r=this.wordTrie.findAllMatches(e);for(let o of r){let a=o.payload;a&&i.push({word:o.word,definition:a,from:t+o.from,to:t+o.to,color:F(a.color,"var(--color-accent)")})}for(let o of this.patternDefinitions)if(o.patternParts&&o.patternParts.length>0){let a=de(e,o.patternParts,t);for(let s of a)i.push({word:o.word,definition:o,from:s.from,to:s.to,color:F(o.color,"var(--color-accent)"),matchedText:s.matchedText,segments:s.segments})}}catch(r){console.error("\u5728 findWordMatches \u4E2D\u53D1\u751F\u9519\u8BEF:",r)}return i}removeOverlaps(e){return e}destroy(){this.debounceTimer&&(window.clearTimeout(this.debounceTimer),this.debounceTimer=null),this.cachedMatches.clear(),this.wordTrie.clear(),U.unregister(this)}};function xe(l,e){let t={decorations:r=>r.decorations};class i extends ge{constructor(o){super(o,l,e)}}return[kt,I.ViewPlugin.fromClass(i,t)]}var P=require("obsidian");var z="hi-words-sidebar",j=class extends P.ItemView{constructor(t,i){super(t);this.currentWords=[];this.activeTab="learning";this.currentFile=null;this.firstLoadForFile=!1;this.updateTimer=null;this.measureQueue=[];this.measureScheduled=!1;this.delegatedBound=!1;this.lastInteractionTime=0;this.patternDefinitionsCache=[];this.normalDefinitionsCache=[];this.plugin=i}scheduleMeasure(){this.measureScheduled||(this.measureScheduled=!0,requestAnimationFrame(()=>{if(this.measureScheduled=!1,this.measureQueue.length===0)return;let t=140,r=this.measureQueue.splice(0,this.measureQueue.length).map(o=>({el:o,needsToggle:o.scrollHeight>t+4}));for(let{el:o,needsToggle:a}of r){if(!a){o.removeClass("collapsed");continue}let s=o.parentElement;if(!s)continue;let n=s.querySelector(".hi-words-expand-overlay");n||(n=s.createEl("div",{cls:"hi-words-expand-overlay"})),n.setText(o.hasClass("collapsed")?d("actions.expand"):d("actions.collapse"))}}))}getViewType(){return z}getDisplayText(){return d("sidebar.title")}getIcon(){return"book-open"}async onOpen(){let t=this.containerEl.children[1];t.empty(),t.addClass("hi-words-sidebar"),this.bindDelegatedHandlers(t),this.scheduleUpdate(0),this.registerEvent(this.app.workspace.on("file-open",i=>{this.scheduleUpdate(120)})),this.registerEvent(this.app.workspace.on("editor-change",()=>{this.scheduleUpdate(500)})),this.registerEvent(this.app.vault.on("modify",i=>{i instanceof P.TFile&&i.extension==="canvas"&&this.scheduleUpdate(250)})),this.registerEvent(this.app.workspace.on("hi-words:mastered-changed",()=>{this.scheduleUpdate(100)})),this.registerEvent(this.app.workspace.on("hi-words:settings-changed",()=>{this.scheduleUpdate(100)}))}async onClose(){}async updateView(){let t=this.app.workspace.getActiveFile();if(!t||t.extension!=="md"&&t.extension!=="pdf"){this.showEmptyState("\u8BF7\u6253\u5F00\u4E00\u4E2A Markdown \u6587\u6863\u6216 PDF \u6587\u4EF6");return}if(t===this.currentFile&&this.currentWords.length>0)return;let i=t!==this.currentFile;this.currentFile=t,i&&(this.firstLoadForFile=!0),await this.scanCurrentDocument(),this.renderWordList()}scheduleUpdate(t){Date.now()-this.lastInteractionTime<500||(this.updateTimer!==null&&(clearTimeout(this.updateTimer),this.updateTimer=null),this.updateTimer=window.setTimeout(()=>{this.updateTimer=null,this.updateView()},Math.max(0,t)))}async scanCurrentDocument(){if(this.currentFile)try{let t;this.currentFile.extension==="pdf"?t=await this.extractPDFText():t=await this.app.vault.cachedRead(this.currentFile),await this.updateDefinitionsCache();let i=[];for(let r of this.normalDefinitionsCache){let o=this.buildSearchRegex(r.word),a=o.exec(t),s=a?a.index:-1;if(s===-1&&r.aliases){for(let n of r.aliases)if(o=this.buildSearchRegex(n),a=o.exec(t),a){s=a.index;break}}s!==-1&&(i.some(n=>n.wordDef.nodeId===r.nodeId)||i.push({wordDef:r,position:s}))}for(let r of this.patternDefinitionsCache)if(r.patternParts&&r.patternParts.length>0){let o=de(t,r.patternParts,0);if(o.length>0){let a=o[0].from;i.some(s=>s.wordDef.nodeId===r.nodeId)||i.push({wordDef:r,position:a})}}i.sort((r,o)=>r.position-o.position),this.currentWords=i.map(r=>r.wordDef)}catch(t){console.error("Failed to scan document:",t),this.currentWords=[]}}async updateDefinitionsCache(){let t=await this.plugin.vocabularyManager.getAllWordDefinitions();this.normalDefinitionsCache=[],this.patternDefinitionsCache=[];for(let i of t)i.isPattern&&i.patternParts&&i.patternParts.length>0?this.patternDefinitionsCache.push(i):this.normalDefinitionsCache.push(i)}async renderWordList(){let t=this.containerEl.querySelector(".hi-words-sidebar");if(!t)return;if(t.empty(),this.bindDelegatedHandlers(t),this.currentWords.length===0){this.showEmptyState(d("sidebar.empty_state"));return}let i=this.currentWords.filter(o=>!o.mastered),r=this.currentWords.filter(o=>o.mastered);this.firstLoadForFile&&this.activeTab==="learning"&&i.length===0&&r.length>0&&(this.activeTab="mastered"),this.firstLoadForFile=!1,this.createTabNavigation(t,i.length,r.length),await this.createTabContent(t,i,r)}createTabNavigation(t,i,r){let o=t.createEl("div",{cls:"hi-words-tab-nav"});o.createEl("div",{cls:`hi-words-tab ${this.activeTab==="learning"?"active":""}`,attr:{"data-tab":"learning"}}).createEl("span",{text:`${d("sidebar.vocabulary_book")} (${i})`}),this.plugin.settings.enableMasteredFeature&&o.createEl("div",{cls:`hi-words-tab ${this.activeTab==="mastered"?"active":""}`,attr:{"data-tab":"mastered"}}).createEl("span",{text:`${d("sidebar.mastered")} (${r})`})}async createTabContent(t,i,r){this.activeTab==="learning"?i.length>0?await this.createWordList(t,i,!1):this.createEmptyState(t,d("sidebar.no_learning_words")):this.activeTab==="mastered"&&(r.length>0?await this.createWordList(t,r,!0):this.createEmptyState(t,d("sidebar.no_mastered_words"))),this.scheduleMeasure()}switchTab(t){this.activeTab!==t&&(this.activeTab=t,this.renderWordList())}async createWordList(t,i,r){let o=t.createEl("div",{cls:"hi-words-word-list"});for(let a of i)await this.createWordCard(o,a,r)}async createWordCard(t,i,r=!1){var h,c;let o=t.createEl("div",{cls:"hi-words-word-card"});if(i.color){let g=F(i.color,"var(--color-base-60)");o.style.setProperty("--word-card-accent-color",g);let p=He(g,.1);o.style.setProperty("--word-card-bg-color",p)}let a=o.createEl("div",{cls:"hi-words-word-title"});if(a.createEl("span",{text:i.word,cls:"hi-words-word-text"}).addEventListener("click",async g=>{g.stopPropagation(),await le(this.plugin,i.word)}),this.plugin.settings.enableMasteredFeature&&this.plugin.masteredService){let g=a.createEl("div",{cls:"hi-words-title-mastered-button",attr:{"aria-label":r?d("actions.unmark_mastered"):d("actions.mark_mastered")}});(0,P.setIcon)(g,r?"frown":"smile")}if(i.definition&&i.definition.trim()){let p=o.createEl("div",{cls:"hi-words-word-definition"}).createEl("div",{cls:"hi-words-collapsible collapsed"}),f=p.createEl("div",{cls:this.plugin.settings.blurDefinitions?"hi-words-definition blur-enabled":"hi-words-definition"});try{let m=this.app.workspace.getMostRecentLeaf(),_=(m==null?void 0:m.view)instanceof P.MarkdownView?m.view:null,b=_&&((h=_.file)==null?void 0:h.path)||((c=this.app.workspace.getActiveFile())==null?void 0:c.path)||"";await P.MarkdownRenderer.render(this.plugin.app,i.definition,f,b,this),requestAnimationFrame(()=>this.bindInternalLinksAndTags(f,b,f))}catch(m){console.error("Markdown \u6E32\u67D3\u5931\u8D25:",m),f.textContent=i.definition}this.measureQueue.push(p)}let n=o.createEl("div",{cls:"hi-words-word-source"}),u=this.getBookNameFromPath(i.source);n.createEl("span",{text:`${d("sidebar.source_prefix")}${u}`,cls:"hi-words-source-text"}),n.addEventListener("click",g=>{g.stopPropagation(),this.navigateToSource(i)}),r&&o.addClass("hi-words-word-card-mastered")}createEmptyState(t,i){t.createEl("div",{cls:"hi-words-empty-state"}).createEl("div",{text:i,cls:"hi-words-empty-text"})}showEmptyState(t){let i=this.containerEl.querySelector(".hi-words-sidebar");if(!i)return;i.empty(),i.createEl("div",{cls:"hi-words-empty-state"}).createEl("div",{text:t,cls:"hi-words-empty-text"})}bindDelegatedHandlers(t){this.delegatedBound||(t.addEventListener("mousedown",i=>{var u,h;let r=i.target;if(!r)return;let o=r.closest(".hi-words-tab");if(o&&t.contains(o)){i.preventDefault(),i.stopPropagation();let c=o.getAttr("data-tab")||"learning";c!==this.activeTab&&this.switchTab(c);return}let a=r.closest(".hi-words-expand-overlay");if(a&&t.contains(a)){i.preventDefault(),i.stopPropagation(),this.lastInteractionTime=Date.now(),this.updateTimer!==null&&(clearTimeout(this.updateTimer),this.updateTimer=null);let c=a.parentElement,p=(c==null?void 0:c.querySelector(".hi-words-collapsible"))||c;if(p){let f=!p.hasClass("collapsed");p.toggleClass("collapsed",f),a.setText(f?d("actions.expand"):d("actions.collapse"))}return}let s=r.closest(".hi-words-title-mastered-button");if(s&&t.contains(s)){i.preventDefault(),i.stopPropagation();let c=s.closest(".hi-words-word-card"),g=!!(c!=null&&c.hasClass("hi-words-word-card-mastered")),p=c==null?void 0:c.querySelector(".hi-words-word-text"),f=(u=p==null?void 0:p.textContent)==null?void 0:u.trim();if(f&&this.plugin.settings.enableMasteredFeature&&this.plugin.masteredService){let m=this.currentWords.find(_=>_.word===f);m&&(async()=>{try{g?await this.plugin.masteredService.unmarkWordAsMastered(m.source,m.nodeId,m.word):await this.plugin.masteredService.markWordAsMastered(m.source,m.nodeId,m.word),setTimeout(()=>this.updateView(),100)}catch(_){console.error("\u5207\u6362\u5DF2\u638C\u63E1\u72B6\u6001\u5931\u8D25:",_)}})()}return}let n=r.closest(".hi-words-word-source");if(n&&t.contains(n)){i.preventDefault(),i.stopPropagation();let c=n.closest(".hi-words-word-card"),g=c==null?void 0:c.querySelector(".hi-words-word-text"),p=(h=g==null?void 0:g.textContent)==null?void 0:h.trim();if(p){let f=this.currentWords.find(m=>m.word===p);f&&this.navigateToSource(f)}return}},{capture:!0}),this.delegatedBound=!0)}getBookNameFromPath(t){var r;let i=this.plugin.settings.vocabularyBooks.find(o=>o.path===t);return i?i.name:((r=t.split("/").pop())==null?void 0:r.replace(".canvas",""))||"\u672A\u77E5"}escapeRegExp(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}async extractPDFText(){try{await new Promise(r=>setTimeout(r,500));let t=document.querySelectorAll(".textLayer"),i="";return t.forEach(r=>{r.closest(".pdf-container, .mod-pdf")&&(r.querySelectorAll('span[role="presentation"]').forEach(s=>{let n=s.textContent||"";n.trim()&&(i+=n+" ")}),i+=`
`)}),i.trim()||document.querySelectorAll(".pdf-container, .mod-pdf").forEach(o=>{let a=o.textContent||"";a.trim()&&(i+=a+`
`)}),i.trim()}catch(t){return console.error("PDF \u6587\u672C\u63D0\u53D6\u5931\u8D25:",t),""}}buildSearchRegex(t){let i=this.escapeRegExp(t),r=/[\p{Script=Han}\p{Script=Hiragana}\p{Script=Katakana}\p{Script=Hangul}]/u.test(t),o=r?`${i}`:`\\b${i}\\b`,a=r?"giu":"gi";return new RegExp(o,a)}bindInternalLinksAndTags(t,i,r){t.querySelectorAll("a.internal-link").forEach(o=>{var n;let a=o,s=(a.getAttribute("href")||((n=a.dataset)==null?void 0:n.href)||"").trim();s&&(a.addEventListener("mouseover",u=>{this.app.workspace.trigger("hover-link",{event:u,source:"hi-words",hoverParent:r,target:a,linktext:s,sourcePath:i})}),a.addEventListener("click",u=>{u.preventDefault(),u.stopPropagation(),this.app.workspace.openLinkText(s,i)}))}),t.querySelectorAll("a.tag").forEach(o=>{let a=o,s=(a.getAttribute("href")||a.textContent||"").trim();s&&a.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),this.openOrUpdateSearch(s.startsWith("#")?s:`#${s}`)})})}openOrUpdateSearch(t){var i;try{let r=this.app.workspace.getLeavesOfType("search");if(r.length>0){let o=r[0].view;(i=o.setQuery)==null||i.call(o,t),this.app.workspace.revealLeaf(r[0]);return}new P.Notice(d("notices.enable_search_plugin")||"\u8BF7\u5148\u542F\u7528\u6838\u5FC3\u641C\u7D22\u63D2\u4EF6")}catch(r){console.error("\u6253\u5F00\u641C\u7D22\u5931\u8D25:",r)}}async navigateToSource(t){try{let i=this.app.vault.getAbstractFileByPath(t.source);i instanceof P.TFile&&(i.extension==="canvas"?await this.app.workspace.openLinkText(i.path,""):(await this.app.workspace.openLinkText(i.path,""),setTimeout(()=>{var o;let r=this.app.workspace.getActiveViewOfType(P.MarkdownView);if(r&&((o=r.file)==null?void 0:o.path)===i.path){let a=r.editor,n=a.getValue().toLowerCase().indexOf(t.word.toLowerCase());if(n!==-1){let u=a.offsetToPos(n);a.setCursor(u),a.scrollIntoView({from:u,to:u},!0)}}},100)))}catch(i){console.error("\u5BFC\u822A\u5230\u6E90\u6587\u4EF6\u5931\u8D25:",i)}}refresh(){this.currentFile=null,this.scheduleUpdate(0)}};var H=require("obsidian");var K=class K extends H.Component{constructor(t){super();this.activeTooltip=null;this.vocabularyManager=null;this.masteredService=null;this.eventHandlers={};this.currentTargetEl=null;this.hoverIntentTimer=null;this.lastShowTs=0;this.currentTooltipComponent=null;this.app=t.app,this.plugin=t,this.eventHandlers={mouseover:i=>this.handleMouseOver(i),mouseout:i=>this.handleMouseOut(i),scroll:(()=>this.removeTooltip()).bind(this),resize:(()=>this.removeTooltip()).bind(this)},this.registerEvents()}bindInternalLinksAndTags(t,i,r){t.querySelectorAll("a.internal-link").forEach(o=>{var n;let a=o,s=(a.getAttribute("href")||((n=a.dataset)==null?void 0:n.href)||"").trim();s&&(a.addEventListener("mouseover",u=>{this.app.workspace.trigger("hover-link",{event:u,source:"hi-words",hoverParent:r,target:a,linktext:s,sourcePath:i})}),a.addEventListener("click",u=>{u.preventDefault(),u.stopPropagation(),this.app.workspace.openLinkText(s,i),this.removeTooltip()}))}),t.querySelectorAll("a.tag").forEach(o=>{let a=o,s=(a.getAttribute("href")||a.textContent||"").trim();s&&a.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),this.openOrUpdateSearch(s.startsWith("#")?s:`#${s}`),this.removeTooltip()})})}openOrUpdateSearch(t){var i;try{let r=this.app.workspace.getLeavesOfType("search");if(r.length>0){let o=r[0].view;(i=o.setQuery)==null||i.call(o,t),this.app.workspace.revealLeaf(r[0]);return}new H.Notice(d("notices.enable_search_plugin")||"\u8BF7\u5148\u542F\u7528\u6838\u5FC3\u641C\u7D22\u63D2\u4EF6")}catch(r){console.error("\u6253\u5F00\u641C\u7D22\u5931\u8D25:",r)}}setVocabularyManager(t){this.vocabularyManager=t}setMasteredService(t){this.masteredService=t}registerEvents(){this.registerDomEvent(document,"mouseover",this.eventHandlers.mouseover),this.registerDomEvent(document,"mouseout",this.eventHandlers.mouseout),this.registerDomEvent(window,"scroll",this.eventHandlers.scroll,{passive:!0}),this.registerDomEvent(window,"resize",this.eventHandlers.resize)}handleMouseOut(t){clearTimeout(this.tooltipHideTimeout),this.hoverIntentTimer!==null&&(clearTimeout(this.hoverIntentTimer),this.hoverIntentTimer=null);let i=t.target,r=t.relatedTarget;r&&this.activeTooltip&&(r===this.activeTooltip||this.activeTooltip.contains(r))||i&&r&&i.classList.contains("hi-words-highlight")&&r.classList.contains("hi-words-highlight")||i&&this.activeTooltip&&this.activeTooltip.contains(i)&&r&&r.classList.contains("hi-words-highlight")||(this.tooltipHideTimeout=window.setTimeout(()=>{this.removeTooltip()},80))}handleMouseOver(t){var o;if(!this.plugin.settings.showDefinitionOnHover)return;let i=t.target,r=(o=i==null?void 0:i.closest)==null?void 0:o.call(i,".hi-words-highlight");if(r){if(this.currentTargetEl===r&&this.activeTooltip)return;this.hoverIntentTimer!==null&&(clearTimeout(this.hoverIntentTimer),this.hoverIntentTimer=null),this.currentTargetEl=r;let a=r.getAttribute("data-word"),s=r.getAttribute("data-definition");if(!a||!s)return;this.hoverIntentTimer=window.setTimeout(()=>{this.hoverIntentTimer=null;let n=Date.now();n-this.lastShowTs<K.MIN_INTERVAL_MS||(this.lastShowTs=n,this.createTooltip(r,a,s))},K.SHOW_DELAY_MS)}}async createTooltip(t,i,r){var u,h;this.removeTooltip();let o=document.createElement("div");o.className="hi-words-tooltip";let a=document.createElement("div");a.className="hi-words-tooltip-title-container";let s=document.createElement("div");s.className="hi-words-tooltip-title",s.textContent=i,a.appendChild(s),s.title="\u70B9\u51FB\u53D1\u97F3",s.addEventListener("click",async c=>{c.stopPropagation(),await le(this.plugin,i)}),o.appendChild(a);let n=document.createElement("div");if(n.className="hi-words-tooltip-content",this.plugin.settings.blurDefinitions?n.classList.add("hi-words-definition","blur-enabled"):n.classList.add("hi-words-definition"),o.appendChild(n),!r||r.trim()==="")n.textContent=d("sidebar.no_definition");else try{let c=this.app.workspace.getActiveViewOfType(H.MarkdownView),g=c&&((u=c.file)==null?void 0:u.path)||((h=this.app.workspace.getActiveFile())==null?void 0:h.path)||"",p=new H.Component;this.addChild(p),this.currentTooltipComponent=p,await H.MarkdownRenderer.render(this.app,r,n,g,p),requestAnimationFrame(()=>this.bindInternalLinksAndTags(n,g,o))}catch(c){console.error("Markdown \u6E32\u67D3\u5931\u8D25:",c),n.textContent=r}if(this.vocabularyManager){let c=this.vocabularyManager.getDefinition(i);if(c&&c.source){if(this.masteredService&&this.masteredService.isEnabled){let m=document.createElement("div");m.className="hi-words-tooltip-title-mastered-button",(0,H.setIcon)(m,c.mastered?"frown":"smile"),m.addEventListener("click",async _=>{_.stopPropagation();try{c.mastered?await this.masteredService.unmarkWordAsMastered(c.source,c.nodeId,c.word):await this.masteredService.markWordAsMastered(c.source,c.nodeId,c.word),this.removeTooltip()}catch(b){console.error("\u5207\u6362\u5DF2\u638C\u63E1\u72B6\u6001\u5931\u8D25:",b)}}),a.appendChild(m)}let g=document.createElement("div");g.className="hi-words-tooltip-source";let p=c.source.split("/").pop()||"",f=p.endsWith(".canvas")?p.slice(0,-7):p;g.textContent=`${d("sidebar.source_prefix")}${f}`,g.addEventListener("click",m=>{m.stopPropagation(),this.navigateToSource(c),this.removeTooltip()}),o.appendChild(g)}}document.body.appendChild(o),requestAnimationFrame(()=>{let c=t.getBoundingClientRect(),g=window.pageYOffset||document.documentElement.scrollTop,p=window.pageXOffset||document.documentElement.scrollLeft,f=window.innerWidth,m=c.left+p,_=c.bottom+g+5;o.style.left=m+"px",o.style.top=_+"px";let b=o.getBoundingClientRect();if(b.right>f-10){let E=b.right-f+10;o.style.left=m-E+"px"}}),o.addEventListener("mouseleave",c=>{this.removeTooltip()}),this.activeTooltip=o}removeTooltip(){clearTimeout(this.tooltipHideTimeout),this.activeTooltip&&this.activeTooltip.parentNode&&(this.activeTooltip.parentNode.removeChild(this.activeTooltip),this.activeTooltip=null),this.currentTooltipComponent&&(this.removeChild(this.currentTooltipComponent),this.currentTooltipComponent=null),this.currentTargetEl=null}async navigateToSource(t){try{let i=this.app.vault.getAbstractFileByPath(t.source);i instanceof H.TFile&&(i.extension==="canvas"?await this.app.workspace.openLinkText(i.path,""):(await this.app.workspace.openLinkText(i.path,""),setTimeout(()=>{var o;let r=this.app.workspace.getActiveViewOfType(H.MarkdownView);if(r&&((o=r.file)==null?void 0:o.path)===i.path){let a=r.editor,n=a.getValue().toLowerCase().indexOf(t.word.toLowerCase());if(n!==-1){let u=a.offsetToPos(n);a.setCursor(u),a.scrollIntoView({from:u,to:u},!0)}}},100)))}catch(i){console.error("\u5BFC\u822A\u5230\u6E90\u6587\u4EF6\u5931\u8D25:",i)}}onunload(){this.removeTooltip()}};K.SHOW_DELAY_MS=120,K.MIN_INTERVAL_MS=150;var ae=K;var k=require("obsidian");var tt=require("obsidian");var X=class{constructor(e){this.cache=new Map;this.CACHE_TTL=1440*60*1e3;this.MAX_RETRIES=3;this.API_ADAPTERS={openai:{buildRequest:(e,t)=>({model:e,messages:[{role:"user",content:t}],temperature:.3,max_tokens:500}),buildHeaders:e=>({Authorization:`Bearer ${e}`}),extractResponse:e=>{var t,i,r;return(r=(i=(t=e==null?void 0:e.choices)==null?void 0:t[0])==null?void 0:i.message)==null?void 0:r.content}},claude:{buildRequest:(e,t)=>({model:e,messages:[{role:"user",content:t}],max_tokens:1024}),buildHeaders:e=>({"x-api-key":e,"anthropic-version":"2023-06-01"}),extractResponse:e=>{var t,i;return(i=(t=e==null?void 0:e.content)==null?void 0:t[0])==null?void 0:i.text}},gemini:{buildRequest:(e,t)=>({contents:[{parts:[{text:t}]}]}),buildHeaders:()=>({}),extractResponse:e=>{var t,i,r,o,a;return(a=(o=(r=(i=(t=e==null?void 0:e.candidates)==null?void 0:t[0])==null?void 0:i.content)==null?void 0:r.parts)==null?void 0:o[0])==null?void 0:a.text},buildUrl:(e,t,i)=>{let r=e;return r.includes(":generateContent")||(r=`${r.replace(/\/$/,"")}/models/${t}:generateContent`),`${r}?key=${i}`}}};this.config=e}detectAPIType(){let e=this.config.apiUrl.toLowerCase();return e.includes("anthropic")?"claude":e.includes("googleapis")||e.includes("generativelanguage")?"gemini":"openai"}validateConfig(){var e,t,i,r;if(!((e=this.config.apiUrl)!=null&&e.trim()))return{isValid:!1,error:d("ai_errors.api_url_required")};if(!((t=this.config.apiKey)!=null&&t.trim()))return{isValid:!1,error:d("ai_errors.api_key_not_configured")};if(!((i=this.config.model)!=null&&i.trim()))return{isValid:!1,error:d("ai_errors.model_required")};if(!((r=this.config.prompt)!=null&&r.trim()))return{isValid:!1,error:d("ai_errors.prompt_required")};try{new URL(this.config.apiUrl)}catch(o){return{isValid:!1,error:d("ai_errors.invalid_api_url")}}return this.config.prompt.includes("{{word}}")?{isValid:!0}:{isValid:!1,error:d("ai_errors.prompt_missing_word_placeholder")}}replacePlaceholders(e,t){return this.config.prompt.replace(/\{\{word\}\}/g,e).replace(/\{\{sentence\}\}/g,t||"")}async fetchDefinition(e,t){if(!(e!=null&&e.trim()))throw new Error(d("ai_errors.word_empty"));let i=this.validateConfig();if(!i.isValid)throw new Error(i.error);let r=e.trim(),o=`${r}:${t||""}`,a=this.cache.get(o);if(a&&Date.now()-a.timestamp<this.CACHE_TTL)return a.content;try{let s=this.detectAPIType(),n=this.API_ADAPTERS[s],u=this.replacePlaceholders(r,t),h=n.buildUrl?n.buildUrl(this.config.apiUrl,this.config.model,this.config.apiKey):this.config.apiUrl,c=n.buildHeaders(this.config.apiKey),g=n.buildRequest(this.config.model,u),p=await this.makeRequestWithRetry(h,c,g),f=n.extractResponse(p);if(!f)throw new Error(d("ai_errors.invalid_response"));let m=f.trim();return this.cache.set(o,{content:m,timestamp:Date.now()}),m}catch(s){throw this.handleError(s)}}async makeRequestWithRetry(e,t,i){let r;for(let o=0;o<this.MAX_RETRIES;o++)try{let a=await(0,tt.requestUrl)({url:e,method:"POST",headers:{"Content-Type":"application/json",...t},body:JSON.stringify(i)});if(a.status>=400)throw new Error(`HTTP ${a.status}: ${a.text}`);return a.json}catch(a){r=a;let s=String(a);if(s.includes("400")||s.includes("401")||s.includes("403")||s.includes("404"))break;if(o<this.MAX_RETRIES-1){let n=1e3*Math.pow(2,o);await new Promise(u=>setTimeout(u,n))}}throw r}handleError(e){let t=(e==null?void 0:e.message)||String(e);return t.includes("401")||t.includes("403")?new Error(d("ai_errors.api_key_invalid")):t.includes("429")?new Error(d("ai_errors.rate_limit")):t.includes("500")||t.includes("502")||t.includes("503")||t.includes("504")?new Error(d("ai_errors.server_error")):t.includes("network")||t.includes("timeout")?new Error(d("ai_errors.network_error")):(console.error("AI Dictionary Error:",e),new Error(`${d("ai_errors.request_failed")}: ${t}`))}clearCache(){this.cache.clear()}getCacheStats(){let e=null;for(let t of this.cache.values())(e===null||t.timestamp<e)&&(e=t.timestamp);return{size:this.cache.size,oldestEntry:e}}};var O=class O extends k.Modal{constructor(e,t,i,r="",o=!1){super(e),this.plugin=t,this.word=i,this.sentence=r,this.isEditMode=o,this.plugin.settings.aiDictionary?this.dictionaryService=new X(this.plugin.settings.aiDictionary):this.dictionaryService=new X({apiUrl:"",apiKey:"",model:"",prompt:""}),o?this.definition=this.plugin.vocabularyManager.getDefinition(i):this.definition=null}onOpen(){let{contentEl:e}=this;e.empty();let t=null;if(!this.isEditMode){let w=e.createDiv({cls:"hiwords-form-item"});w.createEl("label",{text:d("modals.word_label"),cls:"hiwords-form-item-label"}),t=w.createEl("input",{type:"text",placeholder:d("modals.word_placeholder"),cls:"setting-item-input"}),t.value=this.word,this.word||setTimeout(()=>t==null?void 0:t.focus(),50)}let i=e.createDiv({cls:"hiwords-form-item"});i.createEl("label",{text:d("modals.book_label"),cls:"hiwords-form-item-label"});let r=i.createEl("select",{cls:"dropdown"});r.createEl("option",{text:d("modals.select_book"),value:""});let o=this.plugin.settings.vocabularyBooks.filter(w=>w.enabled),a=!1;o.forEach((w,M)=>{let x=r.createEl("option",{text:w.name,value:w.path});(this.isEditMode&&this.definition&&this.definition.source===w.path||!this.isEditMode&&!a&&(O.lastSelectedBookPath&&w.path===O.lastSelectedBookPath||!O.lastSelectedBookPath&&M===0))&&(x.selected=!0,a=!0)}),this.isEditMode&&this.definition&&(r.disabled=!0);let s=e.createDiv({cls:"hiwords-form-item"});s.createEl("label",{text:d("modals.color_label"),cls:"hiwords-form-item-label"});let n=s.createEl("select",{cls:"dropdown setting-item-select"});n.createEl("option",{text:d("modals.color_gray"),value:""}),[{name:d("modals.color_red"),value:"1"},{name:d("modals.color_orange"),value:"2"},{name:d("modals.color_yellow"),value:"3"},{name:d("modals.color_green"),value:"4"},{name:d("modals.color_blue"),value:"5"},{name:d("modals.color_purple"),value:"6"}].forEach(w=>{let M=n.createEl("option",{text:w.name,value:w.value});this.isEditMode&&this.definition&&this.definition.color===w.value&&(M.selected=!0)});let h=e.createDiv({cls:"hiwords-form-item"});h.createEl("label",{text:d("modals.aliases_label"),cls:"hiwords-form-item-label"});let c=h.createEl("input",{type:"text",placeholder:d("modals.aliases_placeholder"),cls:"setting-item-input word-aliases-input"});this.isEditMode&&this.definition&&this.definition.aliases&&this.definition.aliases.length>0&&(c.value=this.definition.aliases.join(", "));let g=e.createDiv({cls:"hiwords-form-item"}),p=g.createDiv({cls:"hiwords-definition-label-container"});p.createEl("label",{text:d("modals.definition_label"),cls:"hiwords-form-item-label"});let f=p.createDiv({cls:"hiwords-auto-fill-btn"}),m=f.createDiv({cls:"hiwords-auto-fill-icon"});(0,k.setIcon)(m,"sparkles"),f.setAttribute("aria-label",d("modals.auto_fill_definition")),f.addEventListener("click",async()=>{var M,x,A;let w=this.isEditMode?this.word:(t==null?void 0:t.value.trim())||"";if(!w){new k.Notice(d("notices.enter_word_first"));return}if(!((M=this.plugin.settings.aiDictionary)!=null&&M.apiUrl)||!((x=this.plugin.settings.aiDictionary)!=null&&x.apiKey)||!((A=this.plugin.settings.aiDictionary)!=null&&A.model)){new k.Notice(d("ai_errors.api_key_not_configured"));return}f.addClass("hiwords-loading"),m.empty(),(0,k.setIcon)(m,"loader");try{let C=await new X(this.plugin.settings.aiDictionary).fetchDefinition(w,this.sentence);_.value=C,new k.Notice(d("notices.definition_fetched"))}catch(y){console.error("Failed to fetch definition:",y);let C=y instanceof Error?y.message:d("notices.definition_fetch_failed");new k.Notice(C)}finally{f.removeClass("hiwords-loading"),m.empty(),(0,k.setIcon)(m,"sparkles")}});let _=g.createEl("textarea",{placeholder:d("modals.definition_placeholder"),cls:"setting-item-input hiwords-word-definition-input"});_.rows=5,this.isEditMode&&this.definition&&this.definition.definition&&(_.value=this.definition.definition),setTimeout(()=>{(!this.isEditMode&&this.word||this.isEditMode&&this.definition)&&_.focus()},50);let b=e.createDiv({cls:"hiwords-modal-button-container"}),E=b.createDiv({cls:"hiwords-button-group-left"});if(this.isEditMode&&this.definition){let w=E.createEl("button",{cls:"delete-word-button"});(0,k.setIcon)(w,"trash"),w.onclick=async()=>{if(!await this.showDeleteConfirmation())return;let x=new k.Notice(d("notices.deleting_word"),0);try{let A=await this.plugin.vocabularyManager.deleteWordFromCanvas(this.definition.source,this.definition.nodeId);x.hide(),A?(new k.Notice(d("notices.word_deleted")),this.plugin.refreshHighlighter(),this.close()):new k.Notice(d("notices.delete_word_failed"))}catch(A){x.hide(),console.error("\u5220\u9664\u8BCD\u6C47\u65F6\u53D1\u751F\u9519\u8BEF:",A),new k.Notice(d("notices.error_deleting_word"))}}}let L=b.createDiv({cls:"hiwords-button-group-right"}),T=L.createEl("button",{text:d("modals.cancel_button")});T.onclick=()=>this.close();let B=this.isEditMode?"modals.save_button":"modals.add_button",G=L.createEl("button",{text:d(B),cls:"mod-cta"});G.onclick=async()=>{let w=this.word;if(!this.isEditMode&&t&&(w=t.value.trim(),!w)){new k.Notice(d("notices.word_required")),t.focus();return}let M=r.value,x=_.value,A=n.value?parseInt(n.value):void 0,y=c.value.trim(),C;if(y&&(C=y.split(",").map(W=>W.trim().toLowerCase()),C=C.filter(W=>W.length>0),C.length===0&&(C=void 0)),!M){new k.Notice(d("notices.select_book_required"));return}let N=this.isEditMode?new k.Notice(d("notices.updating_word"),0):new k.Notice(d("notices.adding_word"),0);try{let W=!1;if(this.isEditMode&&this.definition)if(W=await this.plugin.vocabularyManager.updateWordInCanvas(this.definition.source,this.definition.nodeId,w,x,A,C),N.hide(),W){let Y=d("notices.word_updated_success").replace("{0}",w);new k.Notice(Y),this.plugin.refreshHighlighter(),this.close()}else new k.Notice(d("notices.update_word_failed"));else if(W=await this.plugin.vocabularyManager.addWordToCanvas(M,w,x,A,C),N.hide(),W){O.lastSelectedBookPath=M;let Y=d("notices.word_added_success").replace("{0}",w);new k.Notice(Y),this.plugin.refreshHighlighter(),this.close()}else new k.Notice(d("notices.add_word_failed"))}catch(W){N.hide(),console.error("Failed to add/update word:",W),new k.Notice(d("notices.error_processing_word"))}}}async showDeleteConfirmation(){var e;return window.confirm(d("modals.delete_confirmation").replace("{0}",((e=this.definition)==null?void 0:e.word)||this.word))}onClose(){let{contentEl:e}=this;e.empty()}};O.lastSelectedBookPath=null;var J=O;var v=require("obsidian");var se=class extends v.PluginSettingTab{constructor(e,t){super(e,t),this.plugin=t}addHighlightScopeSettings(){let{containerEl:e}=this;new v.Setting(e).setName(d("settings.highlight_mode")).setDesc(d("settings.highlight_mode_desc")).addDropdown(r=>r.addOption("all",d("settings.mode_all")).addOption("exclude",d("settings.mode_exclude")).addOption("include",d("settings.mode_include")).setValue(this.plugin.settings.highlightMode||"all").onChange(async o=>{this.plugin.settings.highlightMode=o,await this.plugin.saveSettings(),this.plugin.refreshHighlighter()})),new v.Setting(e).setName(d("settings.highlight_paths")).setDesc(d("settings.highlight_paths_desc"));let i=e.createDiv({cls:"hi-words-textarea-container"}).createEl("textarea");i.placeholder=d("settings.highlight_paths_placeholder")||"e.g.: Archive, Templates, Private/Diary",i.value=this.plugin.settings.highlightPaths||"",i.rows=3,i.addEventListener("blur",async()=>{this.plugin.settings.highlightPaths=i.value,await this.plugin.saveSettings(),this.plugin.refreshHighlighter()})}addFileNodeParseModeSettings(){let{containerEl:e}=this;new v.Setting(e).setName(d("settings.file_node_parse_mode")).setDesc(d("settings.file_node_parse_mode_desc")).addDropdown(t=>t.addOption("filename-with-alias",d("settings.mode_filename_with_alias")).addOption("filename",d("settings.mode_filename")).addOption("content",d("settings.mode_content")).setValue(this.plugin.settings.fileNodeParseMode||"filename-with-alias").onChange(async i=>{this.plugin.settings.fileNodeParseMode=i,await this.plugin.saveSettings(),new v.Notice("\u8BF7\u91CD\u65B0\u52A0\u8F7D\u63D2\u4EF6\u4EE5\u5E94\u7528\u65B0\u7684\u6587\u4EF6\u8282\u70B9\u89E3\u6790\u6A21\u5F0F")}))}addAutoLayoutSettings(){let{containerEl:e}=this;new v.Setting(e).setName(d("settings.auto_layout")).setHeading(),new v.Setting(e).setName(d("settings.enable_auto_layout")).setDesc(d("settings.enable_auto_layout_desc")).addToggle(t=>{var i;return t.setValue((i=this.plugin.settings.autoLayoutEnabled)!=null?i:!0).onChange(async r=>{this.plugin.settings.autoLayoutEnabled=r,await this.plugin.saveSettings()})}),new v.Setting(e).setName(d("settings.card_size")||"Card size").setDesc(d("settings.card_size_desc")||"Default width and height for canvas cards").addText(t=>{var i;return t.setPlaceholder("260").setValue(String((i=this.plugin.settings.cardWidth)!=null?i:260)).onChange(async r=>{let o=parseInt(r);!isNaN(o)&&o>0&&(this.plugin.settings.cardWidth=o,await this.plugin.saveSettings())})}).addText(t=>{var i;return t.setPlaceholder("120").setValue(String((i=this.plugin.settings.cardHeight)!=null?i:120)).onChange(async r=>{let o=parseInt(r);!isNaN(o)&&o>0&&(this.plugin.settings.cardHeight=o,await this.plugin.saveSettings())})})}display(){let{containerEl:e}=this;e.empty(),this.addVocabularyBooksSection(),this.addFileNodeParseModeSettings(),this.addHighlightingSection(),this.addLearningFeaturesSection(),this.addAutoLayoutSettings()}addHighlightingSection(){let{containerEl:e}=this;new v.Setting(e).setName(d("settings.enable_auto_highlight")||"Highlighting").setHeading(),new v.Setting(e).setName(d("settings.enable_auto_highlight")).setDesc(d("settings.enable_auto_highlight_desc")).addToggle(t=>t.setValue(this.plugin.settings.enableAutoHighlight).onChange(async i=>{this.plugin.settings.enableAutoHighlight=i,await this.plugin.saveSettings(),this.plugin.refreshHighlighter()})),new v.Setting(e).setName(d("settings.show_definition_on_hover")).setDesc(d("settings.show_definition_on_hover_desc")).addToggle(t=>t.setValue(this.plugin.settings.showDefinitionOnHover).onChange(async i=>{this.plugin.settings.showDefinitionOnHover=i,await this.plugin.saveSettings()})),new v.Setting(e).setName(d("settings.highlight_style")).setDesc(d("settings.highlight_style_desc")).addDropdown(t=>t.addOption("underline",d("settings.style_underline")).addOption("background",d("settings.style_background")).addOption("bold",d("settings.style_bold")).addOption("dotted",d("settings.style_dotted")).addOption("wavy",d("settings.style_wavy")).setValue(this.plugin.settings.highlightStyle).onChange(async i=>{this.plugin.settings.highlightStyle=i,await this.plugin.saveSettings(),this.plugin.refreshHighlighter()})),this.addHighlightScopeSettings()}ensureAIDictionaryConfig(){this.plugin.settings.aiDictionary||(this.plugin.settings.aiDictionary={apiUrl:"",apiKey:"",model:"",prompt:""})}addLearningFeaturesSection(){var a;let{containerEl:e}=this;new v.Setting(e).setName(d("settings.enable_mastered_feature")||"Learning Features").setHeading(),new v.Setting(e).setName(d("settings.enable_mastered_feature")).setDesc(d("settings.enable_mastered_feature_desc")).addToggle(s=>s.setValue(this.plugin.settings.enableMasteredFeature).onChange(async n=>{this.plugin.settings.enableMasteredFeature=n,this.plugin.settings.showMasteredInSidebar=n,await this.plugin.saveSettings(),this.plugin.refreshHighlighter(),this.plugin.app.workspace.trigger("hi-words:mastered-changed"),this.display()}));let t=new v.Setting(e).setName(d("settings.mastered_detection")||"Mastered detection mode").setDesc(d("settings.mastered_detection_desc")||'Choose how to detect "mastered": by group or by color (green = 4)');t.addDropdown(s=>{var n;return s.addOption("group",d("settings.mode_group")||"Group mode").addOption("color",d("settings.mode_color")||"Color mode (green = 4)").setValue((n=this.plugin.settings.masteredDetection)!=null?n:"group").onChange(async u=>{var h;this.plugin.settings.masteredDetection=u,await this.plugin.saveSettings(),(h=this.plugin.vocabularyManager)!=null&&h.updateSettings&&this.plugin.vocabularyManager.updateSettings(this.plugin.settings),await this.plugin.vocabularyManager.loadAllVocabularyBooks(),this.plugin.refreshHighlighter(),this.plugin.app.workspace.trigger("hi-words:settings-changed")})}),this.plugin.settings.enableMasteredFeature||t.setDisabled(!0),new v.Setting(e).setName(d("settings.blur_definitions")).setDesc(d("settings.blur_definitions_desc")).addToggle(s=>s.setValue(this.plugin.settings.blurDefinitions).onChange(async n=>{this.plugin.settings.blurDefinitions=n,await this.plugin.saveSettings(),this.plugin.app.workspace.trigger("hi-words:settings-changed")})),new v.Setting(e).setName(d("settings.tts_template")||"TTS template").setDesc(d("settings.tts_template_desc")||"Use {{word}} as placeholder, e.g. https://dict.youdao.com/dictvoice?audio={{word}}&type=2").addText(s=>s.setPlaceholder("https://...{{word}}...").setValue(this.plugin.settings.ttsTemplate||"https://dict.youdao.com/dictvoice?audio={{word}}&type=2").onChange(async n=>{this.plugin.settings.ttsTemplate=n.trim(),await this.plugin.saveSettings()})),new v.Setting(e).setName(d("settings.ai_dictionary")||"AI Dictionary").setHeading(),new v.Setting(e).setName(d("settings.ai_api_url")||"API URL").setDesc(d("settings.ai_api_url_desc")||"API endpoint (auto-detects: OpenAI, Claude, Gemini). \u26A0\uFE0F Privacy: Words and sentences will be sent to this external service.").addText(s=>{var n;return s.setPlaceholder("https://api.openai.com/v1/chat/completions").setValue(((n=this.plugin.settings.aiDictionary)==null?void 0:n.apiUrl)||"").onChange(async u=>{this.ensureAIDictionaryConfig(),this.plugin.settings.aiDictionary.apiUrl=u.trim(),await this.plugin.saveSettings()})}),new v.Setting(e).setName(d("settings.ai_api_key")||"API Key").setDesc(d("settings.ai_api_key_desc")||"Your AI API key").addText(s=>{var n;s.inputEl.type="password",s.setPlaceholder("sk-...").setValue(((n=this.plugin.settings.aiDictionary)==null?void 0:n.apiKey)||"").onChange(async u=>{this.ensureAIDictionaryConfig(),this.plugin.settings.aiDictionary.apiKey=u.trim(),await this.plugin.saveSettings()})}),new v.Setting(e).setName(d("settings.ai_model")||"Model").setDesc(d("settings.ai_model_desc")||"AI model name (e.g., gpt-4o-mini, deepseek-chat)").addText(s=>{var n;return s.setPlaceholder("gpt-4o-mini").setValue(((n=this.plugin.settings.aiDictionary)==null?void 0:n.model)||"").onChange(async u=>{this.ensureAIDictionaryConfig(),this.plugin.settings.aiDictionary.model=u.trim(),await this.plugin.saveSettings()})}),new v.Setting(e).setName(d("settings.ai_prompt")||"Custom Prompt").setDesc(d("settings.ai_prompt_desc")||"Use {{word}} and {{sentence}} as placeholders. The AI will use this prompt to generate definitions.");let r=e.createDiv({cls:"hi-words-textarea-container"}).createEl("textarea"),o=`Please provide a concise definition for the word "{{word}}" based on this context:

Sentence: {{sentence}}

Format:
1) Part of speech
2) English definition
3) Chinese translation
4) Example sentence (use the original sentence if appropriate)`;r.placeholder=o,r.value=((a=this.plugin.settings.aiDictionary)==null?void 0:a.prompt)||o,r.rows=6,r.addEventListener("blur",async()=>{this.ensureAIDictionaryConfig(),this.plugin.settings.aiDictionary.prompt=r.value,await this.plugin.saveSettings()})}addVocabularyBooksSection(){let{containerEl:e}=this,t=e.createDiv({cls:"hi-words-add-book-container"});t.addEventListener("click",()=>this.showCanvasFilePicker());let i=t.createSpan({text:d("settings.add_vocabulary_book"),cls:"hi-words-add-book-label"}),r=t.createDiv({cls:"clickable-icon hi-words-add-book-icon"});(0,v.setIcon)(r,"plus-circle"),r.setAttribute("aria-label",d("settings.add_vocabulary_book")),this.displayVocabularyBooks(),this.displayStats()}async showCanvasFilePicker(){let e=this.app.vault.getFiles().filter(i=>i.extension==="canvas");if(e.length===0){new v.Notice(d("notices.no_canvas_files"));return}new We(this.app,e,async i=>{await this.addVocabularyBook(i)}).open()}async addVocabularyBook(e){if(this.plugin.settings.vocabularyBooks.some(a=>a.path===e.path)){new v.Notice(d("notices.book_already_exists"));return}if(!await new S(this.app,this.plugin.settings).validateCanvasFile(e)){new v.Notice(d("notices.invalid_canvas_file"));return}let o={path:e.path,name:e.basename,enabled:!0};this.plugin.settings.vocabularyBooks.push(o),await this.plugin.saveSettings(),await this.plugin.vocabularyManager.loadVocabularyBook(o),this.plugin.refreshHighlighter(),new v.Notice(d("notices.book_added").replace("{0}",o.name)),this.display()}displayVocabularyBooks(){let{containerEl:e}=this;if(this.plugin.settings.vocabularyBooks.length===0){e.createEl("p",{text:d("settings.no_vocabulary_books"),cls:"setting-item-description"});return}this.plugin.settings.vocabularyBooks.forEach((t,i)=>{let r=new v.Setting(e).setName(t.name).setDesc(`${d("settings.path")}: ${t.path}`),o=r.controlEl.createDiv({cls:"hi-words-book-icons"}),a=o.createDiv({cls:"clickable-icon"});(0,v.setIcon)(a,"refresh-cw"),a.setAttribute("aria-label",d("settings.reload_book")),a.addEventListener("click",async()=>{await this.plugin.vocabularyManager.reloadVocabularyBook(t.path),this.plugin.refreshHighlighter(),new v.Notice(d("notices.book_reloaded").replace("{0}",t.name))});let s=o.createDiv({cls:"clickable-icon mod-warning"});(0,v.setIcon)(s,"trash"),s.setAttribute("aria-label",d("settings.remove_vocabulary_book")),s.addEventListener("click",async()=>{this.plugin.settings.vocabularyBooks.splice(i,1),await this.plugin.saveSettings(),await this.plugin.vocabularyManager.loadAllVocabularyBooks(),this.plugin.refreshHighlighter(),new v.Notice(d("notices.book_removed").replace("{0}",t.name)),this.display()}),r.addToggle(n=>n.setValue(t.enabled).onChange(async u=>{t.enabled=u,await this.plugin.saveSettings(),u?await this.plugin.vocabularyManager.loadVocabularyBook(t):await this.plugin.vocabularyManager.loadAllVocabularyBooks(),this.plugin.refreshHighlighter()}))})}displayStats(){let{containerEl:e}=this,t=this.plugin.vocabularyManager.getStats(),i=e.createEl("div",{cls:"hi-words-stats"}),r=i.createEl("div",{cls:"stat-item"});r.createEl("div",{cls:"stat-value",text:t.totalBooks.toString()}),r.createEl("div",{cls:"stat-label",text:d("settings.total_books").split(":")[0]});let o=i.createEl("div",{cls:"stat-item"});o.createEl("div",{cls:"stat-value",text:t.enabledBooks.toString()}),o.createEl("div",{cls:"stat-label",text:d("settings.enabled_books").split(":")[0]});let a=i.createEl("div",{cls:"stat-item"});a.createEl("div",{cls:"stat-value",text:t.totalWords.toString()}),a.createEl("div",{cls:"stat-label",text:d("settings.total_words").split(":")[0]})}},We=class extends v.FuzzySuggestModal{constructor(e,t,i){super(e),this.files=t,this.onSelect=i,this.setPlaceholder(d("modals.select_canvas_file"))}getItems(){return this.files}getItemText(e){return e.path}onChooseItem(e,t){this.onSelect(e)}};var me=require("obsidian");function it(l,e){if(!l||e<0||e>l.length)return"";let t=/[.!?\n]/,i=e;for(;i>0;){let a=l[i-1];if(t.test(a))break;i--}let r=e;for(;r<l.length;){let a=l[r];if(t.test(a)){r++;break}r++}return l.substring(i,r).trim()}function pe(l){try{let e=l.getCursor(),t=l.getValue(),i=0;for(let r=0;r<e.line;r++)i+=l.getLine(r).length+1;return i+=e.ch,it(t,i)}catch(e){return console.error("Failed to extract sentence from editor (multiline):",e),""}}function rt(l){if(!l||l.rangeCount===0)return"";try{let e=l.getRangeAt(0),t=l.toString().trim();if(!t)return"";let i=e.startContainer;if(i.nodeType===Node.ELEMENT_NODE){let n=i.childNodes[e.startOffset];n&&n.nodeType===Node.TEXT_NODE&&(i=n)}let r=Et(i);if(!r)return"";let o=r.textContent||"",a=Ct(r,i,e.startOffset,t);if(a===-1)return"";let s=a+Math.floor(t.length/2);return it(o,s)}catch(e){return console.error("Failed to extract sentence from selection:",e),""}}function Et(l){var i,r;let e=l;e.nodeType===Node.TEXT_NODE&&(e=e.parentNode);let t=null;for(;e&&e.nodeType!==Node.DOCUMENT_NODE;){if(e.nodeType===Node.ELEMENT_NODE){let o=e,a=(i=o.tagName)==null?void 0:i.toLowerCase();if(a==="p"||a==="li"||a==="blockquote")return o;if(a==="div"){let s=((r=o.textContent)==null?void 0:r.length)||0;s>0&&s<5e3&&(t=o)}if(o.classList.contains("textLayer"))return o;if(o.classList.contains("page")&&o.closest(".pdf-container")){let s=o.querySelector(".textLayer");if(s)return s}}e=e.parentNode}return t}function Ct(l,e,t,i){var n;let r=document.createTreeWalker(l,NodeFilter.SHOW_TEXT,null),o=0,a;for(;a=r.nextNode();){if(a===e||a.contains(e))return o+t;o+=((n=a.textContent)==null?void 0:n.length)||0}return(l.textContent||"").indexOf(i)}function Me(l){l.addCommand({id:"refresh-vocabulary",name:d("commands.refresh_vocabulary"),callback:async()=>{await l.vocabularyManager.loadAllVocabularyBooks(),l.refreshHighlighter(),new me.Notice(d("notices.vocabulary_refreshed"))}}),l.addCommand({id:"open-vocabulary-sidebar",name:d("commands.show_sidebar"),callback:()=>{l.activateSidebarView()}}),l.addCommand({id:"add-selected-word",name:d("commands.add_selected_word"),callback:()=>{let e="",t="",i=l.app.workspace.getActiveViewOfType(me.MarkdownView),r=i==null?void 0:i.editor,o=i==null?void 0:i.getMode();if(r&&o==="source")e=r.getSelection().trim(),t=pe(r);else{let s=window.getSelection();e=(s==null?void 0:s.toString().trim())||"",!e&&s&&s.rangeCount>0&&(e=s.getRangeAt(0).toString().trim()),t=rt(s)}l.addOrEditWord(e,t)}})}var ne=require("obsidian");function Ae(l){let e=new Set,t=null;l.registerEvent(l.app.vault.on("modify",i=>{i instanceof ne.TFile&&i.extension==="canvas"&&l.settings.vocabularyBooks.some(o=>o.path===i.path)&&e.add(i.path)})),l.registerEvent(l.app.workspace.on("active-leaf-change",async i=>{let r=l.app.workspace.getActiveFile();if(t&&e.has(t)&&(!r||r.path!==t)&&(await l.vocabularyManager.reloadVocabularyBook(t),l.refreshHighlighter(),e.delete(t)),r&&r.extension==="canvas")t=r.path;else if(t=null,e.size>0){let o=Array.from(e);e.clear();for(let a of o)await l.vocabularyManager.reloadVocabularyBook(a);l.refreshHighlighter()}else setTimeout(()=>l.refreshHighlighter(),100)})),l.registerEvent(l.app.vault.on("rename",async(i,r)=>{if(i instanceof ne.TFile&&i.extension==="canvas"){let o=l.settings.vocabularyBooks.findIndex(a=>a.path===r);o!==-1&&(l.settings.vocabularyBooks[o].path=i.path,l.settings.vocabularyBooks[o].name=i.basename,await l.saveSettings(),l.vocabularyManager.removeBookData(r),await l.vocabularyManager.reloadVocabularyBook(i.path),l.refreshHighlighter(),new ne.Notice(d("notices.book_path_updated").replace("{0}",i.basename)))}})),l.registerEvent(l.app.workspace.on("editor-menu",(i,r)=>{let o=r.getSelection();if(o&&o.trim()){let a=o.trim(),s=l.vocabularyManager.hasWord(a);i.addItem(n=>{let u=s?"commands.edit_word":"commands.add_word";n.setTitle(d(u)).onClick(()=>{let h=pe(r);l.addOrEditWord(a,h)})})}}))}var fe=class extends ot.Plugin{constructor(){super(...arguments);this.editorExtensions=[];this.isSidebarInitialized=!1}async onload(){await this.loadSettings(),Te.setApp(this.app),this.vocabularyManager=new re(this.app,this.settings),this.masteredService=new oe(this,this.vocabularyManager),this.definitionPopover=new ae(this),this.addChild(this.definitionPopover),this.definitionPopover.setVocabularyManager(this.vocabularyManager),this.definitionPopover.setMasteredService(this.masteredService),this.registerView(z,t=>new j(t,this)),this.setupEditorExtensions(),this.registerCommands(),this.registerEvents(),Fe(this),Ve(this),this.addSettingTab(new se(this.app,this)),this.initializeSidebar(),this.app.workspace.onLayoutReady(async()=>{await this.vocabularyManager.loadAllVocabularyBooks(),this.refreshHighlighter()})}setupEditorExtensions(){let t=xe(this.vocabularyManager,i=>be(i,this.settings));this.editorExtensions=[t],this.registerEditorExtension(this.editorExtensions)}registerCommands(){Me(this)}registerEvents(){Ae(this)}shouldHighlightFile(t){return be(t,this.settings)}refreshHighlighter(){U.refreshAll(),this._refreshReadingModeHighlighter&&this._refreshReadingModeHighlighter(),this._refreshPDFHighlighter&&this._refreshPDFHighlighter(),this.app.workspace.getLeavesOfType(z).forEach(i=>{i.view instanceof j&&i.view.refresh()})}async initializeSidebar(){this.isSidebarInitialized||this.app.workspace.onLayoutReady(()=>{this.isSidebarInitialized=!0})}async activateSidebarView(){let{workspace:t}=this.app,i=null,r=t.getLeavesOfType(z);r.length>0?i=r[0]:(i=t.getRightLeaf(!1),i&&await i.setViewState({type:z,active:!0})),i&&t.revealLeaf(i)}async loadSettings(){this.settings=Object.assign({},De,await this.loadData())}async saveSettings(){await this.saveData(this.settings),this.vocabularyManager.updateSettings(this.settings),this.masteredService.updateSettings()}addOrEditWord(t,i=""){this.vocabularyManager.hasWord(t)?new J(this.app,this,t,i,!0).open():new J(this.app,this,t,i).open()}onunload(){this.vocabularyManager.clear(),this.vocabularyManager.destroy&&this.vocabularyManager.destroy(),U.clear(),Re(this)}};

/* nosourcemap */